.. _overview:

Overview
========

*Here we give a high-level explanation of how one can construct a
generative model within the X-PSI framework, and apply that model to
astronomical X-ray photon data.*


The overarching concept
-----------------------

X-PSI is designed for the statistical analysis of astronomical X-ray photon
data sets acquired through observation of *pulsed* emission from compact stars.
To achieve this, X-PSI couples code for likelihood evaluation with existing
open-source software for posterior sampling and integration.


X-ray photon data
-----------------

The relevant data is acquired via direct astronomical detection of photons in
the X-ray regime.


Likelihoods
-----------

The likelihood 'distribution' is a function on an :math:`n`-dimensional
parameter space, equal at each point :math:`\boldsymbol{\theta}` (with finite
local prior probability density) to a parametrised sampling distribution on the
space of the data evaluated at the *fixed* dataset :math:`\mathcal{D}`. The
likelihood is defined by

.. math::

    L(\boldsymbol{\theta};\mathcal{M})\mathrel{:=}\mathcal{P}(\mathcal{D}\;|\;\boldsymbol{\theta},\mathcal{M}),

where :math:`\mathcal{M}` is the global (hierarchical) model.

A fundamental assumption upon which X-PSI is based is that the statistical
generative model of interest can be constructed from a restricted set of
abstract mathematical objects. These objects often have properties which are
discrete representations of continuous mathematical structures, and these
continuous structures are imbued with physical and statistical meaning in
order to attempt to describe observable reality in terms of deterministic and
stochastic processes.

In X-PSI, we adopt general relativistic gravity to construct a spacetime
manifold associated with a model compact star.

We first need to consider our X-ray photon data set :math:`\mathcal{D}`: in
general let it be constituted by some union of data subsets
:math:`\mathcal{D}=\cup_{i}\mathcal{D}_{i}`, such that 
:math:`\mathcal{D}_{i}\cap\mathcal{D}_{j}=\emptyset` for :math:`i\neq j`, and
the subsets are statistically independent -- i.e., the joint sampling
distribution conditional on the model is separable. We describe the stochastic
generation of this data via observations -- with a model X-ray telescope -- of
a *single* general relativistic compact model star (the *source*), whose
exterior spacetime parameters we are interested in constraining (primarily for
the purpose of dense matter study). Further, we assume that the data subsets
:math:`\mathcal{D}_{i}` are acquired during disjoint time intervals, and that
the exterior spacetime of the *source* is stationary (and thus
time-independent) over the time interval spanning acquisition of all subsets
which constitute :math:`\mathcal{D}`. More accurately, the spacetime of an
accreting model star in a binary is non-stationary (and thus dynamic), but the
evolution is considered sufficiently small to neglect.

We have not yet given a concrete definition of a data subset
:math:`\mathcal{D}_{i}`: let us define one data subset as having a parametrised
model sampling distribution dependent on a single **pulse** generated by a
rotating non-axisymmetric source radiation field, during which the source
radiation field is everywhere invariant with respect to the proper time in some
local comoving frame (which need not necessarily be the frame of the local
photospheric plasma). Crucially, all data points (photon incidence events)
constituting :math:`\mathcal{D}_{i}` need not be acquired within a single
period of rotation of the source -- indeed, in reality sources are of galactic
origin but are sufficiently distant that the incident flux of photons is very
small. The photon incidence events which comprise :math:`\mathcal{D}_{i}` can
span an arbitrarily long time interval, but over that time interval the source
radiation field is assumed to be stable, with any quasi-periodicity manifesting
due to relative motion the source and a model telescope, and/or due to a small
evolution in the coordinate rotation frequency of the source radiation field.
Each subset :math:`\mathcal{D}_{i}` is acquired with some model instrument with
a response matrix (a photon energy redistribution matrix combined with an
energy-dependent effective area vector) which is used in forward-modelling to
transform a radiation field incident on the detector into a form which enters
directly in the sampling distribution of :math:`\mathcal{D}_{i}`.

.. note:: For an outdated (and unfinished) manuscript on computation of
          incident specific flux pulses (and the references therein) ask the
          author.

Posteriors
----------

The joint posterior distribution on parameter space is the joint probability
density distribution proportional to the integrable product of the likelihood
function with a joint prior distribution.

.. math::

    \mathcal{P}(\boldsymbol{\theta}\;|\;\mathcal{D},\mathcal{M},\mathcal{I})=\frac{L(\boldsymbol{\theta};\mathcal{M})\mathcal{P}(\boldsymbol{\theta}\;|\;\mathcal{M},\mathcal{I})}{\mathcal{P}(\mathcal{D}\;|\;\mathcal{M},\mathcal{I})}

The normalisation is the prior predictive distribution on the space of the data
evaluated at :math:`\mathcal{D}`:

.. math::

    \mathcal{P}(\mathcal{D}\;|\;\mathcal{M},\mathcal{I})
    =\mathop{\int}\mathcal{P}(\mathcal{D}\;|\;\boldsymbol{\theta},\mathcal{M})\mathcal{P}(\boldsymbol{\theta}\;|\;\mathcal{M},\mathcal{I})d^{n}\boldsymbol{\theta}.

Also termed the 'evidence' or 'marginal likelihood', this normalisation can be
approximated by MultiNest.


Parallelisation paradigms
-------------------------

.. _emcee: http://emcee.readthedocs.io/en/latest/
.. _MultiNest: https://github.com/farhanferoz/MultiNest

X-PSI inherits the Open MPI parallelisation of an external sampling package. In
general it is necessary to run X-PSI posterior sampling/integration on
distributed memory architectures (e.g., a cluster or a supercomputer) because
likelihood evaluation times are slow, of :math:`\mathcal{O}(1)\,s`.

In addition, the source code for pulse simulation (required for likelihood
evalution) is OpenMP-enabled, meaning that in principle one can
explore hybrid parallelisation paradigms -- in particular, enabling
multithreaded computation on shared memory nodes of distributed architectures.


Future extension of scope
-------------------------

In future development, support for direct *interior* parameter estimation may
be added. This involves solving the field equations for stable stationary
spacetime solutions and embedding the rotationally deformed stellar surface
into an ambient Schwarzschild spacetime with the rotationally deformed
gravitational mass monopole moment, whilst neglecting all other rotational
:math:`\ell>0` metric deformations at :math:`\mathcal{O}(\Omega)`
(see Hartle, 1967; Hartle & Thorne, 1968).
