.. _applications:

Publications
------------

X-PSI has been applied in the following studies. In addition to giving an
idea of the scientific applications, these may also
be useful for performance benchmarking and planning 
of computational resource consumption. 

If you have used X-PSI for a project and would like to link it here, please
contact the X-PSI team and/or submit a pull-request on GitHub.


Early X-PSI development
***********************

X-PSI was initiated by Thomas Riley as part of his PhD work at the University of Amsterdam. 
Chapter 3 of his `PhD thesis (Riley 2019) <https://hdl.handle.net/11245.1/aa86fcf3-2437-4bc2-810e-cf9f30a98f7a>`_ 
provides an extended technical description of ``v0.1`` of X-PSI and contains
results of some parameter recovery tests using synthetic data.  


NICER rotation-powered millisecond pulsar papers
************************************************

X-PSI has been used in several Pulse Profile Modeling analysis papers using *NICER* data of rotation-powered millisecond pulsars. These are typically published with a Zenodo repository containing data, model files, X-PSI scripts, samples and post-processing notebooks to enable full reproduction and independent analysis. 

**Choudhury et al. 2024b** `(ApJ submitted) <https://ui.adsabs.harvard.edu/abs/2024arXiv240607285C/abstract>`_ *Exploring Waveform Variations among Neutron Star Ray-tracing Codes for Complex Emission Geometries*. 

**Choudhury et al. 2024a** `(ApJL in press) <https://ui.adsabs.harvard.edu/abs/2024arXiv240706789C/abstract>`_ *A NICER View of the Nearest and Brightest Millisecond Pulsar: PSR J0437-4715*. See also the associated `Zenodo repository`__.

.. _Zenodo24c: https://doi.org/10.5281/zenodo.10886504
__ Zenodo24c_ 

**Salmi et al. 2024** `(ApJ in press) <https://ui.adsabs.harvard.edu/abs/2024arXiv240614466S/abstract>`_ *The Radius of the High Mass Pulsar PSR J0740+6620 With 3.6 Years of NICER Data*.  See also the associated `Zenodo repository`__.

.. _Zenodo24b: https://doi.org/10.5281/zenodo.10519472
__ Zenodo24b_

**Vinciguerra et al. 2024** `(ApJ, 961,62) <https://ui.adsabs.harvard.edu/abs/2024ApJ...961...62V/abstract>`_ *An Updated Mass-Radius Analysis of the 2017-2018 NICER Data Set of PSR J0030+0451*. See also the associated `Zenodo repository`__.   

.. _Zenodo24a: https://doi.org/10.5281/zenodo.8239000
__ Zenodo24a_

**Afle et al. 2023** `(Computing in Science and Engineering, 25, 16) <https://ui.adsabs.harvard.edu/abs/2023CSE....25f..16A/abstract>`_ *Reproducing the Results for Neutron Star Interior Composition Explorer Observation of PSR J0030+0451*. 

**Vinciguerra et al. 2023** `(ApJ, 959, 55) <https://ui.adsabs.harvard.edu/abs/2023ApJ...959...55V/abstract>`_ *X-PSI Parameter Recovery for Temperature Map Configurations Inspired by PSR J0030+0451*.  See also the associated `Zenodo repository`__.

.. _Zenodo23b: https://doi.org/10.5281/zenodo.7646352
__ Zenodo23b_


**Salmi et al. 2023** `(ApJ, 956, 138) <https://ui.adsabs.harvard.edu/abs/2023ApJ...956..138S/abstract>`_ *Atmospheric Effects on Neutron Star Parameter Constraints with NICER*.  See also the associated `Zenodo repository`__.

.. _Zenodo23a: https://doi.org/10.5281/zenodo.7449785
__ Zenodo23a_

**Salmi et al. 2022** `(ApJ, 941, 150) <https://ui.adsabs.harvard.edu/abs/2022ApJ...941..150S/abstract>`_ *The Radius of PSR J0740+6620 from NICER with NICER Background Estimates*.  See also the associated `Zenodo repository`__.

.. _Zenodo22: https://doi.org/10.5281/zenodo.6827536
__ Zenodo22_


**Riley et al. 2021**  `(ApJL, 918, L27) <https://ui.adsabs.harvard.edu/abs/2021ApJ...918L..27R/abstract>`_ *A NICER View of the Massive Pulsar PSR J0740+6620 Informed by Radio Timing and XMM-Newton Spectroscopy*. See also the associated `Zenodo repository`__.

.. _Zenodo21: https://doi.org/10.5281/zenodo.4697624
__ Zenodo21_

**Bogdanov et al. 2021**  `(ApJL, 914, L15) <https://ui.adsabs.harvard.edu/abs/2021ApJ...914L..15B/abstract>`_ *Constraining the Neutron Star Mass-Radius Relation and Dense Matter Equation of State with NICER. III. Model Description and Verification of Parameter Estimation Codes*.

**Bogdanov et al. 2019** `(ApJL, 887, L26) <https://ui.adsabs.harvard.edu/abs/2019ApJ...887L..26B/abstract>`_ *Constraining the Neutron Star Mass-Radius Relation and Dense Matter Equation of State with NICER. II. Emission from Hot Spots on a Rapidly Rotating Neutron Star*.

**Bilous et al. 2019** `(ApJL, 887, L23) <https://ui.adsabs.harvard.edu/abs/2019ApJ...887L..23B/abstract>`_ *A NICER View of PSR J0030+0451: Evidence for a Global-scale Multipolar Magnetic Field*. 

**Riley et al. 2019** `(ApJL, 887, L21) <https://ui.adsabs.harvard.edu/abs/2019ApJ...887L..21R/abstract>`_ *A NICER View of PSR J0030+0451: Millisecond Pulsar Parameter Estimation*. See also the associated `Zenodo repository`__.

.. _Zenodo: https://doi.org/10.5281/zenodo.3386448

__ Zenodo_


PPM for other sources
*********************

**Kini et al. 2024b** `(MNRAS, submitted) <https://ui.adsabs.harvard.edu/abs/2024arXiv240510717K/abstract>`_ *Pulse Profile Modelling of Thermonuclear Burst Oscillations III : Constraining the properties of XTE J1814-338*. 

**Kini et al. 2024a** `(MNRAS, 527, 8118) <https://ui.adsabs.harvard.edu/abs/2024MNRAS.527.8118K/abstract>`_ *Pulse profile modelling of thermonuclear burst oscillations - II. Handling variability*.  See also the associated `Zenodo repository`__.

.. _Zenodo24kini: http://dx.doi.org/10.5281/zenodo.8033527
__ Zenodo24kini_

**Kini et al. 2023** `(MNRAS, 522, 3389) <https://ui.adsabs.harvard.edu/abs/2023MNRAS.522.3389K/abstract>`_ *Pulse profile modelling of thermonuclear burst oscillations - I. The effect of neglecting variability*.  See also the associated `Zenodo repository`__.

.. _Zenodo23kini: http://dx.doi.org/10.5281/zenodo.7665653
__ Zenodo23kini_


Settings
********

Below we give details of some settings for the **Riley et al. 2019** paper.  For later papers some changes
were made - see papers for details. 

*Resource consumption*:  The calculations reported were performed on the Dutch national supercomputer
Cartesius, mostly on the *Broadwell* nodes (i.e., using CPUs only, usually
*Broadwell* architecture).
A number of models were applied, with increasing complexity.
Typically, ~1000+ cores were used for posterior sampling, when the
parallelisation is weighted by time consumed.
In total, the sampling problems in R19 required ~450,000 core hours.

*Likelihood function settings*:  On compute nodes, the likelihood function evaluation times ranged from ~1 to
~3 seconds (single-threaded), depending on the model and point in parameter
space.\ [#]_ The parallelisation was purely via MPI, with all but one process
receiving likelihood function evaluation requests.

*Resolution settings*: Number of surface cells/elements per hot (closed) region:\ [#]_ 24x24; 
Number of phases (linearly spaced) = 100; Number of energies (logarithmically spaced) = 175; 
Number of rays (per parallel; linear in cosine of ray angle alpha):\ [#]_ 200

*Interpolation settings*:  Steffen splines (GSL) were used everywhere apart from for the atmosphere, and 
for the atmosphere cubic polynomial interpolants were used in four dimensions.


*Compilation*:  Intel compiler collection,\ [#]_ with the CORE-AVX2 instruction set, for X-PSI
and dependencies (apart from :mod:`numpy`, which was centrally installed).



.. rubric:: Footnotes

.. [#] Variation between models on the same processor results from a
       combination of model complexity and resolution settings. Variation
       as a function of parameters also occurs due to issues like mesh
       construction on the surface subject to the resolution settings.

.. [#] This is the approximate number of cells that have centres lying
       within a hot region. For models where a hot region has two temperature
       components these cells are split between the subregions according to
       area only such that the surface density of cells is commensurate---at
       least for subregions that are commensurate in shape. The *fast*
       precomputation mode was deactivated but if it were activated the
       distribution of cells would further be weighted by the approximate
       total number of counts generated by each subregion.

.. [#] The rays were integrated for each likelihood function call instead of
       loading lookup tables from disk, or using an analytic treatment such as
       a high-order expansion (see, e.g.,
       `rayXpanda <https://github.com/ThomasEdwardRiley/rayXpanda>`_).
       Only primary images were included.

.. [#] On Cartesius (and Lisa), one can simply execute
       ``module load intel/2017b`` to access these compilers from the toolchain.


