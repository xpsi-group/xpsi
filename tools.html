

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tools &mdash; x-psi 3.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=796a81b5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Posterior API" href="posterior_api.html" />
    <link rel="prev" title="Likelihoods" href="likelihood_implementations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            x-psi
              <img src="_static/xpsilogo_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQs and common problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="HPC_systems.html">HPC systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">Future</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Team and acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Start_here.html">Start here</a></li>
<li class="toctree-l1"><a class="reference internal" href="XPSI_101.html">X-PSI 101 - For Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Instrument_synergy.html">Instrument synergy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hot_region_complexity.html">Hot region complexity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Global_surface_emission.html">Global surface emission</a></li>
<li class="toctree-l1"><a class="reference internal" href="Surface_radiation_field_tools.html">Surface radiation field tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modeling_without_statistics.html">Modeling (without statistics)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Polarization.html">Polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Post-processing.html">Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Emitting_patterns_2Dprojection.html">Emitting Patterns 2D Projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="Accretion_disk.html">Accretion disk</a></li>
<li class="toctree-l1"><a class="reference internal" href="Multiple_imaging.html">Multiple imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Importance_sampling.html">Importance Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Module_generator_tutorial.html">Module generator tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example_script_and_modules.html">Example script and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example_job.html">Example job</a></li>
<li class="toctree-l1"><a class="reference internal" href="x_p_sbi.html">Posterior Inference using SBI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="likelihood_api.html">Likelihood API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="extension_modules.html">Extension modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="extensions_overview.html">Overview of extension modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="surface_radiation_field.html">Surface radiation field</a></li>
<li class="toctree-l2"><a class="reference internal" href="likelihood_implementations.html">Likelihoods</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#phase-handling">Phase handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.phase_integrator"><code class="docutils literal notranslate"><span class="pre">phase_integrator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.phase_interpolator"><code class="docutils literal notranslate"><span class="pre">phase_interpolator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#energy-handling">Energy handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.energy_integrator"><code class="docutils literal notranslate"><span class="pre">energy_integrator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.energy_interpolator"><code class="docutils literal notranslate"><span class="pre">energy_interpolator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#synthesis">Synthesis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.synthesise_exposure"><code class="docutils literal notranslate"><span class="pre">synthesise_exposure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#xpsi.tools.synthesise_given_total_count_number"><code class="docutils literal notranslate"><span class="pre">synthesise_given_total_count_number()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="posterior_api.html">Posterior API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">x-psi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="extension_modules.html">Extension modules</a></li>
      <li class="breadcrumb-item active">Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tools">
<span id="id1"></span><h1>Tools<a class="headerlink" href="#tools" title="Link to this heading"></a></h1>
<section id="phase-handling">
<span id="module-xpsi.tools"></span><h2>Phase handling<a class="headerlink" href="#phase-handling" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.phase_integrator">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">phase_integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">exposure_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">signal_phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">phase_shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool</span> <span class="pre">allow_negative=0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.phase_integrator" title="Link to this definition"></a></dt>
<dd><p>Integrate a signal over phase intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exposure_time</strong> (<em>double</em>) – Total exposure time in seconds. The exposure time scales the integrated
signal.</p></li>
<li><p><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in rotational cycles.</p></li>
<li><p><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of signal count rates. Phase
increases with column number.</p></li>
<li><p><strong>signal_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in cycles at which
the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</p></li>
<li><p><strong>phase_shift</strong> (<em>double</em>) – A phase shift in cycles such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>.</p></li>
<li><p><strong>allow_negative</strong> (<em>obj</em>) – A boolean declaring whether to allow negative phase interpolant
integrals. If the interpolant is not a Steffen spline, then the
interpolant of a non-negative function can be negative due to
oscillations. For the default Akima Periodic spline from GSL, such
oscillations should manifest as small relative to those present in
cubic splines, for instance, because it is designed to handle a rapidly
changing second-order derivative.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the phase-shifted signal integrated
over phase intervals and scaled by the exposure time. Phase interval
number increases with column number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.phase_interpolator">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">phase_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">new_phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">phase_shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool</span> <span class="pre">allow_negative=0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.phase_interpolator" title="Link to this definition"></a></dt>
<dd><p>Interpolate a signal in phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in rotational cycles at which to
interpolate.</p></li>
<li><p><strong>signal_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in cycles at which
the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</p></li>
<li><p><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of signal count rates. Phase
increases with column number.</p></li>
<li><p><strong>phase_shift</strong> (<em>double</em>) – A phase shift in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>.</p></li>
<li><p><strong>allow_negative</strong> (<em>obj</em>) – A boolean declaring whether to allow negative phase interpolant
integrals. If the interpolant is not a Steffen spline, then the
interpolant of a non-negative function can be negative due to
oscillations. For the default Akima Periodic spline from GSL, such
oscillations should manifest as small relative to those present in
cubic splines, for instance, because it is designed to handle a rapidly
changing second-order derivative.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the phase-shifted signal interpolated
at the new set of phases. Phase increases with column number.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="energy-handling">
<h2>Energy handling<a class="headerlink" href="#energy-handling" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.energy_integrator">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">energy_integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size_t</span> <span class="pre">N_Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">energy_edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.energy_integrator" title="Link to this definition"></a></dt>
<dd><p>Integrate a signal over energy intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_Ts</strong> (<em>size_t</em>) – Number of OpenMP threads to spawn.</p></li>
<li><p><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of an energy-resolved (specific
flux) signal. Energy increases with row number.</p></li>
<li><p><strong>energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithms (base 10) of the energies.</p></li>
<li><p><strong>energy_edges</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithm (base 10) of the energy
interval edges.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the signal integrated over energy
intervals. Energy interval number increases with row number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.energy_interpolator">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">energy_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size_t</span> <span class="pre">N_Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">new_energies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.energy_interpolator" title="Link to this definition"></a></dt>
<dd><p>Interpolate a signal in energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_Ts</strong> (<em>size_t</em>) – Number of OpenMP threads to spawn.</p></li>
<li><p><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of an energy-resolved (specific
_signal) signal. Energy increases with row number.</p></li>
<li><p><strong>energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithms (base 10) of the energies at
which the <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is resolved.</p></li>
<li><p><strong>new_energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithm (base 10) of the energies at
which to interpolate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the signal interpolated at the new set
of energies. Energy increases with row number.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="synthesis">
<h2>Synthesis<a class="headerlink" href="#synthesis" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.synthesise_exposure">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">synthesise_exposure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">exposure_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">expected_background_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">background</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_negative=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gsl_seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.synthesise_exposure" title="Link to this definition"></a></dt>
<dd><p>Synthesise Poissonian count numbers given an exposure time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exposure_time</strong> (<em>double</em>) – Exposure time in seconds by which to scale the expected count rate</p></li>
<li><p><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in cycles.</p></li>
<li><p><strong>components</strong> (<em>tuple</em>) – Component signals, each a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of
signal count rates where phase increases with column number.</p></li>
<li><p><strong>component_phases</strong> (<em>tuple</em>) – For each component, a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases
in cycles at which the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on
the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>. Typically this is more finely spaced than the
resulting synthesised data.</p></li>
<li><p><strong>phase_shift</strong> (<em>array-like</em>) – Phase shifts in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>, for
the component signals.</p></li>
<li><p><strong>expected_background_counts</strong> (<em>double</em>) – The total expected number of background counts to set the background
normalisation (given the exposure time).</p></li>
<li><p><strong>background</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of background expected
<em>counts</em>, whose shape matches the number of channels in each element
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">components</span></code> and the number of phase intervals (i.e. one element
fewer than phase interval edges) constructed from <code class="xref py py-obj docutils literal notranslate"><span class="pre">phases</span></code>.</p></li>
<li><p><strong>gsl_seed</strong> (<em>int</em>) – Seed number for adding random noise to the data. If not specified,
seed is based on the clock time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(2D</span> <span class="pre">ndarray,</span> <span class="pre">2D</span> <span class="pre">ndarray,</span> <span class="pre">double)</span></code>. The first element is
the expected count numbers in joint phase-channel intervals. Note those
are intervals, not edges. The second element is a stochastic realisation
of those count numbers. The last element is the required normalisation of
the background.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xpsi.tools.synthesise_given_total_count_number">
<span class="sig-prename descclassname"><span class="pre">xpsi.tools.</span></span><span class="sig-name descname"><span class="pre">synthesise_given_total_count_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">expected_star_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">expected_background_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">::1]</span> <span class="pre">background</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_negative=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gsl_seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.synthesise_given_total_count_number" title="Link to this definition"></a></dt>
<dd><p>Synthesise Poissonian count numbers given expected target source counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in cycles.</p></li>
<li><p><strong>expected_star_counts</strong> (<em>float</em>) – Total number of expected counts from the star (the target source) to
require.</p></li>
<li><p><strong>expected_background_stars</strong> (<em>float</em>) – Total number of expected background counts to require.</p></li>
<li><p><strong>components</strong> (<em>tuple</em>) – Component signals, each a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of
signal count rates where phase increases with column number.</p></li>
<li><p><strong>component_phases</strong> (<em>tuple</em>) – For each component, a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases
in cycles at which the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on
the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>. Typically this is more finely spaced than the
resulting synthesised data.</p></li>
<li><p><strong>phase_shift</strong> (<em>array-like</em>) – Phase shifts in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>, for
the component signals.</p></li>
<li><p><strong>expected_background_counts</strong> (<em>double</em>) – The total expected number of background counts to set the background
normalisation (given the exposure time).</p></li>
<li><p><strong>background</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of background expected
<em>counts</em>, whose shape matches the number of channels in each element
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">components</span></code> and the number of phase intervals (i.e. one element
fewer than phase interval edges) constructed from <code class="xref py py-obj docutils literal notranslate"><span class="pre">phases</span></code>.</p></li>
<li><p><strong>allow_negative</strong> (<em>obj</em>) – A boolean or an array of booleans, one per component, declaring whether
to allow negative phase interpolant integrals. If the interpolant is
not a Steffen spline, then the interpolant of a non-negative function
can be negative due to oscillations. For the default Akima Periodic
spline from GSL, such oscillations should manifest as small relative
to those present in cubic splines, for instance, because it is
designed to handle a rapidly changing second-order derivative.</p></li>
<li><p><strong>gsl_seed</strong> (<em>int</em>) – Seed number for adding random noise to the data. If not specified,
seed is based on the clock time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(2D</span> <span class="pre">ndarray,</span> <span class="pre">2D</span> <span class="pre">ndarray,</span> <span class="pre">double,</span> <span class="pre">double)</span></code>. The first element
is the expected count numbers in joint phase-channel intervals. Note those
are intervals, not edges. The second element is a stochastic realisation
of those count numbers. The third element is the required exposure time.
The last element is the required normalisation of the background.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="likelihood_implementations.html" class="btn btn-neutral float-left" title="Likelihoods" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="posterior_api.html" class="btn btn-neutral float-right" title="Posterior API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025 the X-PSI Core Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>