
import numpy as np
import math

import xpsi

np.random.seed(xpsi._rank+10)

class CustomInstrument(xpsi.Instrument):

    """ Fake telescope response. """

    def __call__(self, signal, *args):
        """ Overwrite base just to show it is possible.

        We loaded only a submatrix of the total instrument response
        matrix into memory, so here we can simplify the method in the
        base class.

        """
        matrix = self.construct_matrix()

        self._folded_signal = np.dot(matrix, signal)

        return self._folded_signal

    @classmethod
    def from_response_files(cls, ARF, RMF, channel_edges,max_input,
                            min_input=0,channel=[1,1500],
                            ):
        """ Constructor which converts response files into :class:`numpy.ndarray`s.
        :param str ARF: Path to ARF which is compatible with
                                :func:`numpy.loadtxt`.
        :param str RMF: Path to RMF which is compatible with
                                :func:`numpy.loadtxt`.
        :param str channel_edges: Path to edges which is compatible with
                                  :func:`numpy.loadtxt`.
        """

        if min_input != 0:
            min_input = int(min_input)

        max_input = int(max_input)

        matrix = np.ascontiguousarray(RMF[min_input:max_input,channel[0]:channel[1]].T, dtype=np.double)

        edges = np.zeros(ARF[min_input:max_input,2].shape[0]+1, dtype=np.double)



        edges[0] = ARF[min_input,0]; edges[1:] = ARF[min_input:max_input,1]

        for i in range(matrix.shape[0]):
            matrix[i,:] *= ARF[min_input:max_input,2]


        channels = np.arange(channel[0],channel[1])


        return cls(matrix, edges, channels, channel_edges[channel[0]:channel[1]+1,1])

class CustomPhotosphere(xpsi.Photosphere):
    """ Implement method for imaging."""

    @property
    def global_variables(self):

        return np.array([self['h__super_colatitude'],
                          self['h__phase_shift'] * _2pi,
                          self['h__super_radius'],
                          self['h__super_temperature']])

from xpsi.likelihoods.default_background_marginalisation import eval_marginal_likelihood
from xpsi.likelihoods.default_background_marginalisation import precomputation

class CustomSignal(xpsi.Signal):
    """ A custom calculation of the logarithm of the NICER likelihood.

    We extend the :class:`xpsi.Signal.Signal` class to make it callable.

    We overwrite the body of the __call__ method. The docstring for the
    abstract method is copied.

    """

    def __init__(self, workspace_intervals = 1000, epsabs = 0, epsrel = 1.0e-8,
                 epsilon = 1.0e-3, sigmas = 10.0, support = None, *args, **kwargs):
        """ Perform precomputation. """

        super(CustomSignal, self).__init__(*args, **kwargs)

        try:
            self._precomp = precomputation(self._data.counts.astype(np.int32))
        except AttributeError:
            print('No data... can synthesise data but cannot evaluate a '
                  'likelihood function.')
        else:
            self._workspace_intervals = workspace_intervals
            self._epsabs = epsabs
            self._epsrel = epsrel
            self._epsilon = epsilon
            self._sigmas = sigmas

            if support is not None:
                self._support = support
            else:
                self._support = -1.0 * np.ones((self._data.counts.shape[0],2))
                self._support[:,0] = 0.0

    @property
    def support(self):
        return self._support

    @support.setter
    def support(self, obj):
        self._support = obj

    def __call__(self, *args, **kwargs):
        self.loglikelihood, self.expected_counts, self.background_signal,self.background_given_support = \
                eval_marginal_likelihood(self._data.exposure_time,
                                          self._data.phases,
                                          self._data.counts,
                                          self._signals,
                                          self._phases,
                                          self._shifts,
                                          self._precomp,
                                          self._support,
                                          self._workspace_intervals,
                                          self._epsabs,
                                          self._epsrel,
                                          self._epsilon,
                                          self._sigmas,
                                          kwargs.get('llzero'))

from scipy.stats import truncnorm
from xpsi.global_imports import _G, _csq, _km, _2pi, gravradius, _dpr
from scipy.interpolate import Akima1DInterpolator
from scipy.stats import truncnorm

class CustomPrior(xpsi.Prior):
    """ A custom (joint) prior distribution.

    Source: Fictitious
    Model variant: ST-

    """

    __derived_names__ = ['compactness', 'phase_separation',]

    def __init__(self):
        """ Nothing to be done.

        A direct reference to the spacetime object could be put here
        for use in __call__:

        .. code-block::

            self.spacetime = ref

        Instead we get a reference to the spacetime object through the
        a reference to a likelihood object which encapsulates a
        reference to the spacetime object.

        """
        super(CustomPrior, self).__init__() # not strictly required if no hyperparameters

    def __call__(self, p = None):
        """ Evaluate distribution at ``p``.

        :param list p: Model parameter values.

        :returns: Logarithm of the distribution evaluated at ``p``.

        """
        temp = super(CustomPrior, self).__call__(p)
        if not np.isfinite(temp):
            return temp

        # based on contemporary EOS theory
        if not self.parameters['radius'] <= 16.0:
            return -np.inf

        ref = self.parameters.star.spacetime # shortcut

        # Compactness limit
        R_p = 1.0 + ref.epsilon * (-0.788 + 1.030 * ref.zeta)
        if R_p < 1.76 / ref.R_r_s:
            return -np.inf

        mu = math.sqrt(-1.0 / (3.0 * ref.epsilon * (-0.788 + 1.030 * ref.zeta)))

        # 2-surface cross-section have a single maximum in |z|
        # i.e., an elliptical surface; minor effect on support, if any,
        # for high spin frequenies
        if mu < 1.0:
            return -np.inf

        ref = self.parameters

        return 0.0

    def inverse_sample(self, hypercube=None):
        """ Draw sample uniformly from the distribution via inverse sampling. """

        to_cache = self.parameters.vector

        if hypercube is None:
            hypercube = np.random.rand(len(self))

        # the base method is useful, so to avoid writing that code again:
        _ = super(CustomPrior, self).inverse_sample(hypercube)

        ref = self.parameters # shortcut

        idx = ref.index('distance')
        ref['distance'] = truncnorm.ppf(hypercube[idx], -5.0, 5.0, loc=1.0, scale=0.1)

        # flat priors in cosine of hot region centre colatitudes (isotropy)
        # support modified by no-overlap rejection condition
        idx = ref.index('hot__super_colatitude')
        a, b = ref.get_param('hot__super_colatitude').bounds
        a = math.cos(a); b = math.cos(b)
        ref['hot__super_colatitude'] = math.acos(b + (a - b) * hypercube[idx])


        # restore proper cache
        for parameter, cache in zip(ref, to_cache):
            parameter.cached = cache

        # it is important that we return the desired vector because it is
        # automatically written to disk by MultiNest and only by MultiNest
        return self.parameters.vector

    def transform(self, p, **kwargs):
        """ A transformation for post-processing. """

        p = list(p) # copy

        # used ordered names and values
        ref = dict(zip(self.parameters.names, p))

        # compactness ratio M/R_eq
        p += [gravradius(ref['mass']) / ref['radius']]

        return p
  
class TestLikelihoodCheck(object):

    def test_likelihood_is_correct(self):
        # Data
        #if __name__ == '__main__':
	    #    data_path = "../Data/xpsi_good_realisation.dat"
        #else:
	    #    data_path = "./Data/xpsi_good_realisation.dat"

        #try:
	    #    data_loaded = np.loadtxt(data_path, dtype=np.double)
        #except:
	    #    print("Loading the data assuming the notebook was run for documentation pages")
	    #    data_loaded = np.loadtxt('../../examples/examples_fast/Data/xpsi_good_realisation.dat', dtype=np.double)

        data_loaded = np.array([[ 22.,  19.,  19.,  25.,  25.,  32.,  39.,  56.,  60.,  69.,  74.,
         79.,  95., 104.,  83., 108.,  82., 109.,  90.,  85.,  69.,  73.,
         72.,  63.,  47.,  42.,  20.,  25.,  11.,  16.,  14.,  21.],
       [ 19.,  17.,  20.,  34.,  25.,  47.,  50.,  59.,  71.,  64.,  90.,
         90.,  93.,  99., 101.,  85., 114.,  97.,  95.,  75.,  66.,  69.,
         58.,  63.,  62.,  36.,  41.,  33.,  24.,  24.,  16.,  21.],
       [ 14.,  29.,  10.,  21.,  25.,  32.,  41.,  51.,  66.,  81.,  71.,
         78.,  92., 103., 106., 114., 106.,  88.,  91.,  98.,  81.,  80.,
         67.,  61.,  46.,  39.,  34.,  29.,  27.,  18.,  27.,  16.],
       [ 13.,  19.,  19.,  26.,  34.,  31.,  52.,  44.,  70.,  71.,  79.,
        101., 111., 103., 101.,  99.,  96.,  86.,  78.,  84.,  78.,  74.,
         74.,  63.,  45.,  35.,  34.,  37.,  18.,  25.,  16.,  15.],
       [ 18.,  16.,  22.,  21.,  22.,  40.,  40.,  49.,  61.,  64., 105.,
         95., 104., 107., 117., 102., 106., 113., 100., 101.,  74.,  70.,
         63.,  64.,  47.,  36.,  26.,  15.,  14.,  28.,  18.,  18.],
       [ 19.,  20.,  18.,  23.,  18.,  30.,  52.,  51.,  50.,  74.,  75.,
         94., 114.,  96., 101.,  85., 112., 102., 113.,  92.,  79.,  84.,
         62.,  64.,  39.,  46.,  31.,  21.,  21.,  23.,  26.,  18.],
       [ 15.,  15.,  18.,  33.,  30.,  39.,  52.,  54.,  45.,  74.,  80.,
         89.,  83., 106., 117.,  98.,  95., 106.,  85.,  89.,  84.,  62.,
         64.,  62.,  60.,  51.,  31.,  28.,  25.,  14.,  12.,  17.],
       [ 12.,  22.,  17.,  22.,  32.,  24.,  45.,  38.,  68.,  83.,  88.,
         90.,  84., 107., 104., 100., 115., 108.,  91.,  88.,  87.,  68.,
         58.,  68.,  49.,  36.,  38.,  34.,  27.,  17.,  15.,  13.],
       [ 10.,  22.,  11.,  22.,  24.,  31.,  43.,  68.,  86.,  80., 106.,
         96.,  96., 118.,  97., 103., 106.,  96., 101.,  87.,  82., 108.,
         56.,  52.,  37.,  44.,  39.,  34.,  26.,  18.,  20.,  12.],
       [ 24.,  18.,  11.,  17.,  31.,  39.,  48.,  58.,  61.,  76.,  90.,
        107., 104., 114., 122., 123., 112.,  97.,  89.,  93., 104.,  74.,
         75.,  64.,  49.,  44.,  38.,  26.,  27.,  19.,  18.,  14.],
       [  9.,  16.,  25.,  27.,  25.,  35.,  50.,  54.,  60.,  75.,  95.,
         90.,  96., 106., 110., 108., 102., 105.,  96.,  82.,  95.,  66.,
         65.,  68.,  60.,  44.,  37.,  32.,  23.,  16.,  20.,  15.],
       [ 14.,  23.,   9.,  23.,  29.,  37.,  40.,  59.,  82.,  71.,  88.,
         97., 131., 116., 121., 125., 104.,  86., 105., 114.,  84.,  81.,
         69.,  56.,  55.,  38.,  38.,  22.,  36.,  25.,  20.,  18.],
       [ 14.,  14.,  14.,  29.,  28.,  24.,  28.,  47.,  75.,  74.,  94.,
        102., 107., 113., 111., 115., 119., 107., 114.,  79.,  94.,  93.,
         78.,  64.,  63.,  39.,  34.,  25.,  23.,  25.,  15.,  17.],
       [ 20.,  19.,  17.,  20.,  30.,  36.,  57.,  45.,  74.,  73.,  94.,
        105., 104.,  96., 104., 109., 102., 113., 124.,  91.,  94.,  88.,
         61.,  59.,  56.,  29.,  39.,  25.,  19.,  24.,   9.,   9.],
       [ 14.,  19.,  20.,  32.,  25.,  49.,  51.,  42.,  74.,  88., 101.,
         87., 108., 117., 131., 109., 112., 142.,  95., 115.,  85.,  75.,
         70.,  67.,  56.,  31.,  42.,  32.,  19.,  19.,  21.,  16.],
       [ 16.,  18.,  21.,  40.,  25.,  36.,  49.,  56.,  64.,  79., 114.,
         98., 104., 113., 102., 124., 117., 109., 107.,  88.,  88.,  94.,
         85.,  42.,  62.,  33.,  45.,  40.,  29.,  14.,  21.,  16.],
       [ 13.,  20.,  23.,  17.,  30.,  32.,  44.,  69.,  63., 101., 116.,
         95., 107., 126., 116., 142., 113., 117., 119.,  96.,  96.,  71.,
         71.,  66.,  48.,  51.,  39.,  26.,  29.,  24.,  12.,  21.],
       [ 16.,  17.,  21.,  19.,  26.,  41.,  63.,  68.,  83.,  69., 127.,
         96., 108., 123., 134., 114., 118., 108., 107.,  96., 108.,  95.,
         73.,  69.,  69.,  52.,  34.,  21.,  25.,  21.,  16.,  17.],
       [ 10.,  18.,  20.,  25.,  26.,  29.,  44.,  63.,  75.,  96., 100.,
        108., 101., 105., 114., 106., 119., 101., 108.,  97., 103.,  91.,
         77.,  80.,  56.,  45.,  40.,  35.,  33.,  22.,  22.,  16.],
       [ 16.,  14.,  18.,  20.,  37.,  30.,  38.,  41.,  87.,  91.,  77.,
        120.,  99., 113., 145., 124., 115., 110., 121., 113.,  90.,  97.,
         75.,  67.,  38.,  41.,  35.,  28.,  27.,  21.,  15.,  10.],
       [ 15.,  16.,  19.,  23.,  37.,  32.,  56.,  58.,  79.,  98., 111.,
        143., 121., 110., 139., 122., 136., 125., 135., 102.,  76.,  72.,
         76.,  74.,  47.,  58.,  38.,  30.,  18.,  21.,  14.,  16.],
       [ 24.,  15.,  15.,  20.,  38.,  48.,  56.,  62.,  71.,  86.,  85.,
        115., 120., 137., 125., 111., 132., 146., 109., 102., 112.,  73.,
         69.,  62.,  58.,  27.,  47.,  29.,  29.,  20.,  20.,  14.],
       [ 17.,  21.,  18.,  15.,  25.,  44.,  49.,  66.,  68.,  98.,  96.,
        118., 140., 138., 115., 112., 125., 142., 115., 114.,  83., 106.,
         75.,  63.,  64.,  43.,  34.,  29.,  39.,  20.,  14.,  15.],
       [ 14.,  19.,   8.,  21.,  31.,  33.,  60.,  65.,  75.,  80., 106.,
        130., 116., 122., 120., 148., 128., 109.,  98., 105., 110.,  87.,
         71.,  71.,  39.,  45.,  31.,  35.,  21.,  19.,  18.,  15.],
       [ 14.,   9.,  17.,  23.,  24.,  32.,  45.,  68.,  73.,  85., 124.,
        118., 109., 129., 127., 101., 127., 121., 133., 119., 107.,  84.,
         60.,  72.,  44.,  49.,  29.,  27.,  25.,  19.,  16.,  21.],
       [  5.,  16.,  10.,  21.,  33.,  47.,  62.,  65.,  89.,  90., 103.,
        120., 119., 125., 112., 139., 128., 130., 122., 103., 108.,  88.,
         76.,  62.,  61.,  50.,  37.,  26.,  24.,  20.,  19.,  14.],
       [ 10.,  15.,  17.,  23.,  25.,  42.,  47.,  60.,  88.,  93., 111.,
        126., 131., 138., 131., 135., 136., 129., 123., 123.,  93.,  96.,
         72.,  69.,  57.,  43.,  46.,  33.,  20.,  20.,  17.,  23.],
       [  9.,  16.,  12.,  20.,  27.,  37.,  37.,  76.,  81., 101., 107.,
        116., 146., 119., 131., 127., 133., 124., 107.,  95., 115.,  74.,
         68.,  75.,  73.,  51.,  37.,  36.,  24.,  17.,  13.,  15.],
       [  5.,  24.,  22.,  22.,  28.,  36.,  44.,  72.,  78., 112., 105.,
        106., 105., 120., 152., 121., 136., 144., 132.,  96., 108.,  90.,
         84.,  68.,  54.,  43.,  39.,  27.,  27.,  28.,  18.,  12.],
       [ 13.,  17.,  28.,  22.,  34.,  42.,  51.,  64.,  72.,  85., 120.,
        119., 110., 135., 143., 121., 122., 134., 117., 105., 106.,  97.,
         81.,  70.,  65.,  45.,  43.,  26.,  25.,  18.,  14.,  14.],
       [  9.,   8.,  19.,  18.,  33.,  42.,  53.,  59.,  76., 102., 107.,
        132., 146., 148., 125., 132., 119., 113., 120., 138., 102.,  82.,
         97.,  64.,  64.,  48.,  37.,  29.,  29.,  16.,  16.,  11.],
       [ 21.,  19.,  22.,  27.,  30.,  40.,  44.,  84.,  77., 114., 126.,
        130., 124., 115., 146., 141., 134., 139., 115., 106., 101.,  93.,
         69.,  82.,  60.,  46.,  34.,  37.,  29.,  16.,  11.,  12.],
       [ 17.,  13.,  17.,  25.,  33.,  36.,  62.,  54.,  83., 100., 103.,
        105., 138., 136., 131., 132., 128., 124., 128., 119., 101., 100.,
         83.,  73.,  64.,  49.,  37.,  29.,  26.,  19.,  22.,  11.],
       [ 15.,  19.,  14.,  24.,  38.,  42.,  42.,  58.,  80., 123., 115.,
        122., 142., 139., 130., 128., 129., 117., 109., 108.,  99.,  99.,
         93.,  70.,  49.,  39.,  41.,  25.,  15.,  16.,  17.,  12.],
       [ 14.,  17.,  24.,  26.,  24.,  47.,  54.,  52.,  82., 109., 110.,
        156., 140., 129., 143., 124., 151., 124., 125., 122., 102.,  87.,
         86.,  74.,  56.,  50.,  39.,  38.,  23.,  20.,  17.,  14.],
       [  6.,  16.,  22.,  22.,  35.,  38.,  58.,  73.,  88.,  91., 108.,
        146., 126., 143., 133., 157., 125., 141., 133., 121., 103.,  93.,
         70.,  71.,  72.,  50.,  38.,  29.,  19.,  24.,  17.,  18.],
       [ 20.,  13.,  19.,  21.,  37.,  36.,  54.,  80.,  91.,  88., 117.,
        122., 140., 133., 150., 132., 144., 137., 128., 120.,  87.,  88.,
         90.,  72.,  68.,  51.,  38.,  41.,  27.,  20.,  15.,  12.],
       [ 13.,  19.,  24.,  22.,  36.,  35.,  70.,  73.,  90.,  86., 111.,
        116., 144., 139., 165., 134., 134., 117., 126., 132.,  96.,  86.,
         91.,  64.,  50.,  49.,  42.,  24.,  22.,  26.,  14.,  12.],
       [ 11.,  15.,  19.,  26.,  35.,  40.,  50.,  66.,  70.,  99., 104.,
        130., 120., 168., 154., 142., 160., 123., 122., 116., 105., 112.,
         87.,  78.,  67.,  57.,  45.,  35.,  26.,  19.,  19.,  22.],
       [ 16.,  14.,  11.,  21.,  33.,  49.,  69.,  85.,  76., 102., 130.,
        124., 138., 175., 161., 122., 154., 141., 139., 120., 123.,  84.,
         87.,  70.,  69.,  40.,  44.,  43.,  31.,  22.,  16.,  10.],
       [ 14.,  11.,  21.,  27.,  35.,  55.,  82.,  62.,  95.,  81., 116.,
        124., 145., 137., 140., 157., 140., 154., 129., 109.,  99.,  97.,
         92.,  74.,  80.,  54.,  33.,  32.,  32.,  24.,  22.,   9.],
       [  9.,  16.,  12.,  19.,  26.,  33.,  58.,  65.,  99.,  92., 116.,
        124., 137., 137., 159., 165., 136., 120., 132., 121., 115.,  90.,
         83.,  85.,  57.,  42.,  39.,  30.,  16.,  17.,  18.,  20.],
       [ 18.,  13.,  18.,  28.,  29.,  41.,  77.,  79.,  89., 113., 115.,
        135., 158., 145., 164., 142., 161., 137., 146., 128., 102., 102.,
        108.,  66.,  65.,  56.,  25.,  37.,  22.,  20.,  20.,  15.],
       [  5.,  17.,  18.,  25.,  34.,  47.,  69.,  71.,  98., 114., 116.,
        135., 138., 138., 152., 120., 140., 141., 144., 101., 105.,  98.,
         81.,  77.,  62.,  45.,  48.,  36.,  34.,  13.,  18.,  14.],
       [ 23.,  18.,   8.,  31.,  24.,  44.,  47.,  87.,  85., 111., 131.,
        139., 148., 153., 163., 146., 159., 144., 130., 130.,  86.,  88.,
         89.,  73.,  77.,  50.,  43.,  34.,  22.,  20.,  18.,  16.],
       [ 10.,  13.,  15.,  19.,  28.,  42.,  51.,  75.,  91., 121., 116.,
        114., 135., 145., 128., 157., 150., 131., 120., 109., 113.,  97.,
         84.,  68.,  66.,  49.,  45.,  37.,  27.,  24.,  23.,  18.],
       [ 13.,  10.,  18.,  29.,  29.,  37.,  59.,  59.,  94., 102., 108.,
        143., 126., 158., 147., 140., 136., 133., 114., 130., 106., 105.,
         92.,  76.,  66.,  60.,  28.,  35.,  24.,  21.,  14.,  12.],
       [ 16.,  12.,  17.,  29.,  43.,  34.,  61.,  82.,  88., 101., 119.,
        123., 143., 134., 150., 139., 155., 128., 132., 118., 103.,  97.,
         89.,  78.,  62.,  41.,  50.,  33.,  26.,  12.,  18.,  12.],
       [ 13.,  15.,   5.,  30.,  34.,  47.,  52.,  69.,  90., 105., 109.,
        117., 135., 140., 162., 168., 171., 143., 109., 135., 126., 113.,
         88.,  73.,  61.,  58.,  39.,  40.,  25.,  19.,  18.,  13.],
       [ 16.,  24.,  28.,  23.,  26.,  47.,  38.,  80.,  93., 119., 111.,
        154., 146., 170., 162., 138., 146., 170., 157., 134., 106., 105.,
         99.,  87.,  54.,  49.,  33.,  32.,  17.,  21.,  17.,  15.],
       [ 10.,  19.,  23.,  23.,  33.,  38.,  49.,  67.,  78., 107., 123.,
        124., 173., 146., 167., 153., 149., 160., 127., 121., 114.,  95.,
         92.,  84.,  62.,  51.,  47.,  40.,  30.,  17.,  21.,  19.],
       [ 12.,  15.,  20.,  28.,  42.,  39.,  57.,  79.,  92., 117., 115.,
        131., 158., 167., 160., 153., 154., 150., 128., 115., 104., 108.,
         97.,  72.,  71.,  39.,  38.,  29.,  30.,  17.,  16.,  17.],
       [ 13.,  17.,  16.,  25.,  34.,  49.,  48.,  79.,  88., 116., 104.,
        150., 141., 161., 155., 137., 132., 125., 120., 123., 114., 106.,
         94.,  85.,  64.,  53.,  31.,  25.,  30.,  24.,   8.,  14.],
       [ 20.,  21.,  21.,  30.,  28.,  40.,  54.,  77.,  81.,  95., 108.,
        146., 169., 166., 194., 135., 144., 137., 135., 137., 102.,  99.,
         86.,  76.,  65.,  55.,  40.,  30.,  20.,  19.,  16.,  10.],
       [ 14.,  18.,  17.,  30.,  27.,  44.,  45.,  63.,  88.,  91., 131.,
        137., 138., 146., 143., 161., 154., 145., 152., 131.,  97.,  96.,
         71.,  81.,  56.,  54.,  38.,  35.,  23.,  23.,  24.,  16.],
       [ 13.,  21.,  22.,  30.,  32.,  43.,  48.,  64.,  90.,  97., 126.,
        130., 152., 167., 134., 167., 135., 167., 131., 130., 127.,  85.,
        100.,  62.,  64.,  64.,  44.,  31.,  30.,  24.,  27.,  17.],
       [ 10.,  23.,  22.,  31.,  28.,  52.,  49.,  63.,  99., 113., 115.,
        142., 164., 162., 169., 160., 162., 136., 111., 144., 139., 100.,
         98.,  70.,  56.,  37.,  42.,  42.,  25.,  22.,  15.,  20.],
       [ 16.,  11.,  23.,  21.,  39.,  39.,  67.,  78., 101., 104., 131.,
        149., 152., 153., 182., 161., 134., 146., 122., 120., 127., 106.,
         94.,  62.,  77.,  47.,  38.,  33.,  22.,  22.,  17.,   9.],
       [ 21.,  12.,  16.,  26.,  34.,  34.,  45.,  84.,  96.,  95., 123.,
        145., 164., 160., 179., 170., 140., 140., 135., 111., 125.,  80.,
         90.,  70.,  83.,  49.,  49.,  23.,  23.,  17.,  17.,  15.],
       [ 18.,  13.,  14.,  34.,  40.,  51.,  60.,  68., 103.,  85., 105.,
        145., 153., 175., 138., 138., 167., 134., 129., 135., 107., 100.,
         84.,  74.,  73.,  42.,  47.,  27.,  27.,  22.,  13.,  15.],
       [ 18.,  15.,   9.,  25.,  29.,  43.,  64.,  85.,  81., 108., 130.,
        156., 156., 155., 154., 162., 145., 142., 131., 110., 130.,  90.,
         93.,  71.,  69.,  50.,  41.,  31.,  25.,  21.,  18.,  11.],
       [ 18.,  14.,  21.,  27.,  32.,  37.,  60.,  65., 109., 107., 152.,
        140., 158., 165., 134., 176., 128., 147., 142., 113., 125., 108.,
         81.,  95.,  63.,  45.,  39.,  25.,  30.,  21.,  17.,  18.],
       [ 18.,  19.,  16.,  28.,  23.,  43.,  50.,  71.,  93., 116., 128.,
        141., 163., 141., 175., 166., 163., 132., 136., 118., 125., 110.,
         73.,  99.,  58.,  52.,  33.,  25.,  17.,  19.,  16.,   7.],
       [ 16.,  11.,  16.,  26.,  35.,  35.,  68.,  86.,  87., 145., 133.,
        137., 149., 151., 136., 165., 156., 161., 138., 148., 123., 113.,
         89.,  76.,  69.,  46.,  41.,  39.,  22.,  19.,  22.,  20.],
       [ 12.,  13.,  22.,  30.,  38.,  32.,  60.,  76.,  94., 118., 114.,
        130., 154., 158., 178., 169., 157., 154., 147., 134., 132., 112.,
        109.,  77.,  61.,  53.,  60.,  30.,  26.,  21.,  20.,  11.],
       [ 17.,  20.,  18.,  22.,  41.,  49.,  55.,  78., 101., 110., 129.,
        148., 129., 155., 153., 166., 139., 164., 122., 121., 120., 102.,
         88.,  92.,  73.,  47.,  37.,  35.,  24.,  20.,   7.,  12.],
       [ 14.,  17.,   9.,  24.,  28.,  53.,  58.,  83.,  86., 117., 124.,
        126., 161., 178., 179., 175., 157., 129., 156., 131., 111.,  95.,
         89.,  91.,  65.,  58.,  42.,  28.,  34.,  20.,  13.,  15.],
       [ 14.,  18.,  18.,  35.,  33.,  49.,  56.,  83.,  87., 106., 136.,
        137., 162., 162., 182., 149., 171., 154., 153., 140., 116., 113.,
         98.,  84.,  57.,  73.,  46.,  29.,  36.,  26.,  13.,   8.],
       [ 11.,   9.,  20.,  28.,  44.,  47.,  53.,  93.,  77., 127., 145.,
        140., 162., 160., 146., 127., 165., 138., 153., 131., 111.,  96.,
         77., 100.,  65.,  51.,  41.,  25.,  32.,  13.,  16.,  17.],
       [ 16.,  14.,  24.,  24.,  38.,  50.,  65.,  64.,  94., 102., 131.,
        128., 148., 139., 163., 167., 165., 131., 142., 134.,  99., 126.,
         92.,  90.,  65.,  70.,  39.,  32.,  21.,  21.,  20.,  15.],
       [ 19.,  20.,  26.,  28.,  39.,  50.,  62.,  80.,  76., 124., 134.,
        143., 128., 150., 146., 179., 154., 152., 140., 130., 112.,  85.,
        100.,  74.,  70.,  56.,  36.,  37.,  27.,  21.,  21.,  17.],
       [  9.,  20.,  21.,  17.,  41.,  50.,  54.,  63.,  99.,  98., 143.,
        139., 161., 166., 167., 167., 157., 139., 141., 137., 114., 109.,
         89.,  85.,  58.,  52.,  49.,  34.,  24.,  28.,  22.,  13.],
       [ 11.,  17.,  25.,  25.,  29.,  47.,  58.,  72., 125., 137., 146.,
        152., 156., 162., 141., 145., 163., 140., 149., 131., 131.,  90.,
         95.,  76.,  62.,  44.,  39.,  52.,  26.,  15.,  19.,  13.],
       [ 15.,  21.,  19.,  20.,  27.,  40.,  50.,  72.,  99., 119., 145.,
        157., 145., 162., 163., 152., 151., 163., 135., 110., 123.,  93.,
         82.,  70.,  74.,  45.,  33.,  39.,  30.,  23.,  19.,  15.],
       [  9.,  14.,  14.,  20.,  44.,  34.,  60.,  85., 109., 110., 120.,
        138., 168., 160., 153., 159., 152., 136., 150.,  96.,  92., 108.,
        103.,  69.,  71.,  57.,  54.,  30.,  23.,  20.,  11.,  10.],
       [ 12.,  13.,  22.,  24.,  36.,  42.,  63.,  61.,  94., 108., 123.,
        161., 163., 116., 162., 167., 166., 153., 132., 134., 110., 115.,
         81.,  81.,  70.,  52.,  47.,  36.,  19.,  16.,  26.,  17.],
       [ 10.,  10.,  18.,  25.,  38.,  40.,  63.,  66., 103., 122., 122.,
        139., 164., 154., 174., 145., 169., 143., 127., 138., 112., 105.,
         92.,  81.,  56.,  51.,  35.,  37.,  31.,  13.,  20.,  22.],
       [ 16.,  17.,  13.,  23.,  32.,  48.,  65.,  77.,  82., 113., 135.,
        142., 170., 175., 164., 188., 183., 141., 128., 101., 123.,  94.,
         97.,  67.,  61.,  64.,  40.,  30.,  34.,  13.,  15.,  17.],
       [ 16.,  20.,  14.,  21.,  30.,  48.,  77.,  67.,  88., 112., 135.,
        123., 172., 167., 153., 145., 152., 149., 146., 121., 107., 112.,
        101.,  79.,  77.,  58.,  29.,  43.,  34.,  20.,  11.,  15.],
       [ 11.,  18.,  18.,  27.,  34.,  48.,  74.,  68.,  99., 113., 123.,
        152., 174., 158., 158., 160., 163., 151., 137., 119., 111., 114.,
        108.,  84.,  69.,  65.,  40.,  31.,  19.,  23.,  19.,  13.],
       [ 17.,  15.,  11.,  28.,  36.,  54.,  50.,  85., 104., 111., 140.,
        119., 149., 162., 137., 150., 159., 143., 139., 135., 115., 113.,
         75.,  60.,  60.,  56.,  53.,  29.,  24.,  25.,  17.,  19.],
       [ 14.,  12.,  23.,  28.,  24.,  50.,  53.,  67.,  95., 117., 125.,
        158., 162., 152., 156., 194., 143., 150., 143., 118., 130., 102.,
         88.,  83.,  74.,  62.,  43.,  25.,  27.,  24.,  24.,  14.],
       [ 14.,  18.,  21.,  29.,  38.,  56.,  64.,  76.,  87., 115., 142.,
        137., 158., 171., 163., 153., 147., 156., 147., 117., 125.,  93.,
         96.,  69.,  62.,  51.,  45.,  36.,  27.,  23.,  17.,  10.],
       [ 20.,  15.,  13.,  21.,  34.,  54.,  65.,  79.,  84., 110., 133.,
        159., 137., 172., 169., 149., 175., 130., 139., 133., 144., 115.,
         99.,  81.,  62.,  53.,  31.,  31.,  23.,  18.,  13.,  10.],
       [ 13.,  12.,  17.,  28.,  34.,  59.,  64.,  77.,  94., 105., 113.,
        141., 177., 156., 186., 164., 158., 132., 148., 123., 111., 108.,
         93.,  72.,  75.,  46.,  45.,  40.,  20.,  23.,  19.,  12.],
       [ 23.,  15.,  17.,  35.,  27.,  40.,  67.,  58.,  90., 113., 111.,
        151., 159., 169., 146., 168., 135., 163., 120., 155., 102., 114.,
         86.,  80.,  68.,  51.,  39.,  32.,  26.,  21.,  13.,  10.],
       [ 11.,  22.,  24.,  27.,  25.,  49.,  57.,  86., 106., 108., 137.,
        164., 150., 155., 181., 175., 153., 176., 145., 141., 156., 108.,
         89.,  77.,  81.,  50.,  41.,  27.,  31.,  20.,  15.,  15.],
       [ 13.,  11.,  24.,  44.,  40.,  43.,  52.,  75.,  98., 122., 140.,
        151., 159., 187., 159., 148., 154., 165., 140., 145.,  95.,  96.,
        101.,  74.,  82.,  53.,  58.,  34.,  27.,  21.,  17.,  17.],
       [ 13.,   8.,  19.,  20.,  35.,  44.,  74.,  68., 113., 116., 128.,
        142., 159., 158., 165., 149., 152., 148., 137., 116., 105., 117.,
         93.,  78.,  67.,  50.,  34.,  38.,  16.,  17.,  18.,  13.],
       [ 19.,  11.,  15.,  30.,  30.,  40.,  53.,  52., 107., 126., 119.,
        142., 159., 154., 155., 160., 171., 178., 116., 123., 113.,  99.,
         95.,  68.,  59.,  54.,  34.,  37.,  21.,  15.,  13.,  16.],
       [ 10.,  12.,  21.,  27.,  44.,  45.,  59.,  70., 105., 124., 133.,
        163., 158., 167., 193., 160., 144., 160., 149., 128., 121., 114.,
         85.,  66.,  73.,  64.,  39.,  32.,  27.,  22.,  16.,  11.],
       [ 16.,  12.,  18.,  22.,  34.,  43.,  64.,  79., 111., 112., 132.,
        129., 166., 161., 158., 172., 170., 153., 133., 115., 129., 106.,
         89.,  78.,  64.,  50.,  45.,  30.,  22.,  19.,  13.,  17.],
       [ 10.,  22.,  17.,  24.,  28.,  47.,  61.,  73.,  92., 124., 127.,
        137., 137., 158., 170., 132., 179., 132., 145., 119., 130., 107.,
         72.,  86.,  59.,  45.,  47.,  38.,  24.,  24.,  19.,  15.],
       [ 18.,  16.,  21.,  32.,  41.,  46.,  65.,  84.,  84.,  71., 119.,
        144., 126., 161., 166., 170., 155., 141., 146., 132., 110., 109.,
         83.,  72.,  65.,  54.,  38.,  32.,  25.,  24.,  12.,  21.],
       [ 15.,  20.,  23.,  31.,  24.,  43.,  57.,  69.,  98., 114., 140.,
        134., 141., 171., 178., 151., 149., 165., 150., 130., 125.,  98.,
         73.,  80.,  65.,  57.,  41.,  28.,  21.,  15.,  12.,  10.],
       [ 12.,  14.,  25.,  34.,  29.,  41.,  56.,  76.,  97., 100., 136.,
        163., 159., 156., 162., 140., 155., 145., 118., 137., 125., 109.,
         85.,  62.,  68.,  47.,  40.,  31.,  23.,  18.,  23.,   8.],
       [ 11.,  19.,  21.,  22.,  38.,  39.,  72.,  75.,  95., 112., 135.,
        151., 161., 173., 155., 162., 179., 148., 121., 123., 123.,  98.,
         83.,  80.,  69.,  55.,  47.,  28.,  31.,  12.,  13.,  11.],
       [ 12.,  15.,  12.,  26.,  27.,  37.,  59.,  68.,  77., 116., 112.,
        149., 149., 174., 148., 149., 147., 138., 139., 123., 106., 103.,
         93.,  67.,  62.,  60.,  41.,  34.,  17.,  14.,  23.,  15.],
       [ 13.,  16.,  13.,  26.,  16.,  45.,  67.,  72.,  79., 120., 133.,
        159., 161., 166., 153., 159., 170., 154., 140., 129., 123.,  87.,
         97.,  85.,  69.,  55.,  41.,  35.,  32.,  21.,  15.,   8.],
       [ 13.,  19.,  16.,  25.,  36.,  31.,  72.,  85.,  91., 118., 148.,
        163., 170., 158., 150., 159., 134., 162., 140., 128., 125., 102.,
        106.,  77.,  64.,  64.,  35.,  34.,  23.,  20.,  15.,  12.],
       [ 13.,  16.,  22.,  30.,  40.,  44.,  65.,  67.,  97., 124., 133.,
        127., 123., 155., 177., 150., 133., 148., 133., 125., 104., 102.,
         90.,  79.,  67.,  59.,  43.,  28.,  25.,  19.,  15.,  14.],
       [ 13.,  16.,  21.,  21.,  35.,  35.,  61.,  81.,  95., 134., 121.,
        127., 144., 164., 139., 150., 176., 133., 142., 127., 115., 110.,
         91.,  64.,  58.,  65.,  42.,  36.,  17.,  14.,  21.,  24.],
       [ 19.,  18.,  18.,  31.,  25.,  51.,  65.,  83.,  95., 113., 146.,
        149., 157., 196., 161., 157., 153., 147., 138., 149., 116., 102.,
         78.,  84.,  57.,  61.,  46.,  34.,  26.,  17.,  17.,  13.],
       [ 18.,  19.,  19.,  19.,  40.,  49.,  53.,  85., 108., 112., 134.,
        146., 131., 145., 159., 157., 164., 158., 134., 137., 109., 110.,
         80.,  74.,  57.,  51.,  40.,  31.,  15.,  21.,   7.,  22.],
       [ 16.,  16.,  11.,  22.,  38.,  46.,  55.,  65., 101., 134., 132.,
        147., 154., 159., 152., 170., 150., 153., 116., 124., 114.,  96.,
         75.,  74.,  63.,  59.,  38.,  30.,  26.,  18.,  18.,  18.],
       [ 11.,  15.,  16.,  20.,  26.,  55.,  75.,  87.,  90., 111., 143.,
        132., 178., 123., 140., 171., 157., 134., 119., 133., 105., 112.,
         90.,  74.,  69.,  51.,  37.,  26.,  19.,  18.,  21.,  17.],
       [ 15.,  19.,  16.,  27.,  29.,  44.,  58.,  79.,  91., 106., 124.,
        121., 142., 160., 160., 150., 152., 144., 121., 124., 127., 105.,
         75.,  76.,  66.,  50.,  32.,  38.,  23.,  24.,  16.,  13.],
       [ 23.,  16.,  18.,  37.,  38.,  50.,  55.,  75.,  95., 118., 130.,
        139., 155., 146., 121., 160., 158., 144., 130., 128., 118., 103.,
         94.,  62.,  65.,  56.,  38.,  34.,  16.,  14.,  14.,  19.],
       [ 11.,  24.,  23.,  26.,  26.,  44.,  61.,  69.,  94., 132., 145.,
        163., 145., 143., 162., 153., 154., 130., 144., 129., 102., 109.,
         75.,  83.,  64.,  63.,  47.,  24.,  22.,  23.,  18.,  18.],
       [ 14.,  18.,  16.,  19.,  36.,  50.,  53.,  82., 108., 134., 124.,
        132., 140., 144., 174., 177., 151., 141., 127., 130., 106., 106.,
         74.,  62.,  66.,  52.,  44.,  33.,  20.,  23.,  22.,  18.],
       [ 17.,  16.,  19.,  18.,  33.,  45.,  68.,  84., 109., 110., 114.,
        162., 141., 148., 182., 170., 181., 139., 133., 115., 102., 120.,
         80.,  65.,  82.,  47.,  36.,  38.,  31.,  14.,  19.,  14.],
       [ 10.,  20.,  25.,  22.,  27.,  49.,  74.,  74.,  84., 110., 135.,
        134., 150., 141., 155., 142., 149., 144., 131.,  99., 112.,  95.,
         84.,  95.,  59.,  59.,  33.,  28.,  27.,  23.,  17.,  13.],
       [ 17.,  16.,  20.,  25.,  31.,  49.,  56.,  78.,  91., 102., 129.,
        131., 134., 155., 150., 147., 136., 148., 158., 122., 110.,  82.,
         95.,  78.,  61.,  45.,  41.,  42.,  29.,  15.,  17.,  14.],
       [ 14.,  11.,  26.,  25.,  30.,  49.,  73.,  79.,  86., 100., 147.,
        146., 153., 154., 166., 178., 162., 166., 129., 128., 105., 104.,
         99.,  78.,  72.,  47.,  37.,  38.,  33.,  22.,  15.,  17.],
       [ 12.,  13.,  22.,  26.,  34.,  34.,  59.,  90.,  80., 108., 122.,
        178., 160., 152., 151., 136., 136., 131., 133., 128., 104., 116.,
         84.,  76.,  57.,  45.,  45.,  32.,  25.,  16.,  15.,  17.],
       [  9.,  19.,   8.,  17.,  28.,  52.,  53.,  80.,  83., 107., 131.,
        119., 129., 140., 168., 152., 142., 136., 123., 117., 104.,  76.,
         92.,  70.,  58.,  46.,  30.,  30.,  27.,  17.,  24.,   7.],
       [ 21.,  12.,  21.,  22.,  39.,  48.,  51.,  89.,  94., 147., 124.,
        132., 161., 159., 153., 157., 181., 134., 135., 124., 126., 114.,
         90.,  63.,  59.,  51.,  53.,  38.,  26.,  25.,  16.,  12.],
       [  6.,  11.,  19.,  27.,  28.,  51.,  48.,  76.,  97., 112., 132.,
        151., 172., 142., 148., 156., 150., 137., 139., 122., 102., 107.,
         77.,  92.,  58.,  44.,  43.,  25.,  21.,  17.,  10.,  16.],
       [ 13.,   9.,  19.,  23.,  33.,  57.,  59.,  83.,  85., 101., 135.,
        130., 160., 162., 146., 160., 151., 139., 123., 133., 116.,  86.,
         79.,  78.,  57.,  47.,  33.,  31.,  24.,  21.,  13.,  16.],
       [  9.,  13.,  23.,  20.,  31.,  41.,  63.,  77.,  80., 107., 134.,
        146., 154., 162., 177., 129., 145., 117., 152., 116., 111., 101.,
         85.,  65.,  46.,  51.,  30.,  32.,  25.,  11.,  19.,  20.],
       [ 13.,  21.,  17.,  21.,  38.,  48.,  41.,  75.,  80., 113., 139.,
        122., 136., 136., 138., 166., 160., 139., 135., 116., 111.,  94.,
         65.,  71.,  59.,  43.,  53.,  22.,  28.,  22.,  11.,  23.],
       [  7.,  12.,  14.,  26.,  30.,  42.,  60.,  68.,  85., 106., 115.,
        140., 140., 164., 171., 141., 138., 133., 133., 123., 141.,  76.,
        100.,  70.,  48.,  59.,  40.,  30.,  18.,  24.,  20.,   8.],
       [ 18.,  13.,  25.,  33.,  39.,  45.,  69.,  78.,  95., 125., 119.,
        121., 164., 159., 127., 143., 134., 156., 140., 128.,  89.,  87.,
        100.,  72.,  57.,  48.,  46.,  25.,  25.,  12.,  18.,  17.],
       [  8.,  15.,  18.,  23.,  36.,  41.,  66.,  81.,  89., 137., 138.,
        115., 141., 139., 149., 150., 143., 135., 140., 109., 100., 109.,
         84.,  70.,  50.,  44.,  25.,  31.,  30.,  13.,  12.,  10.],
       [  6.,  12.,  21.,  25.,  30.,  31.,  61.,  79.,  87., 121., 118.,
        145., 144., 159., 164., 158., 150., 134., 123., 136., 106.,  85.,
         82.,  76.,  62.,  38.,  40.,  41.,  16.,  20.,  22.,  12.],
       [  7.,  16.,  20.,  29.,  31.,  52.,  66.,  56.,  99., 114., 129.,
        130., 149., 166., 150., 145., 173., 138., 114., 118.,  84., 104.,
         86.,  81.,  67.,  49.,  29.,  30.,  24.,  16.,  13.,   7.],
       [  9.,  13.,  24.,  22.,  37.,  42.,  57.,  68., 108., 112., 115.,
        144., 143., 144., 158., 150., 158., 134., 136., 132., 118.,  81.,
         83.,  68.,  61.,  48.,  43.,  27.,  24.,  17.,  14.,  16.],
       [ 11.,  12.,  18.,  19.,  32.,  49.,  50.,  67.,  94., 109., 113.,
        124., 147., 144., 151., 144., 141., 131., 123., 111., 103.,  93.,
         74.,  84.,  59.,  50.,  42.,  20.,  19.,  12.,  18.,  11.],
       [ 13.,  13.,  10.,  22.,  30.,  43.,  72.,  90.,  82., 131., 109.,
        128., 130., 154., 141., 153., 133., 135., 141., 109.,  95., 100.,
         77.,  69.,  61.,  44.,  37.,  41.,  11.,  13.,  14.,  11.],
       [ 10.,  17.,  24.,  26.,  40.,  53.,  55.,  93.,  82., 128., 118.,
        135., 152., 133., 138., 149., 134., 124., 127., 114., 113.,  88.,
         91.,  82.,  67.,  40.,  31.,  20.,  21.,  22.,  22.,  12.],
       [ 23.,   6.,  22.,  23.,  23.,  41.,  64.,  76.,  82., 108., 111.,
        134., 147., 166., 156., 149., 117., 134., 121., 112.,  86.,  91.,
         83.,  59.,  58.,  39.,  39.,  21.,  29.,  13.,  11.,  12.],
       [ 21.,  17.,  13.,  31.,  29.,  47.,  48.,  76.,  97., 107., 108.,
        123., 135., 135., 158., 161., 130., 139., 117., 114., 105.,  94.,
         82.,  70.,  53.,  38.,  30.,  21.,  17.,  12.,  14.,  18.],
       [ 11.,  18.,  19.,  19.,  35.,  44.,  52.,  78.,  85., 118., 133.,
        116., 130., 156., 154., 157., 123., 153., 126., 103.,  96.,  83.,
         78.,  69.,  53.,  55.,  43.,  26.,  28.,  14.,  20.,  11.],
       [ 11.,  14.,  11.,  24.,  34.,  44.,  58.,  67.,  75.,  98., 110.,
        111., 136., 155., 135., 135., 151., 139., 120., 100., 113.,  87.,
         75.,  64.,  72.,  46.,  32.,  35.,  27.,  24.,   7.,  15.],
       [ 13.,   8.,  17.,  29.,  30.,  35.,  59.,  74.,  91., 110., 123.,
        131., 155., 144., 144., 156., 145., 134., 125., 120.,  94.,  89.,
         76.,  79.,  53.,  42.,  41.,  23.,  35.,  14.,  16.,  14.],
       [ 12.,  16.,  11.,  32.,  31.,  51.,  46.,  92.,  79.,  97., 127.,
        121., 155., 157., 151., 171., 168., 152., 104., 104.,  98.,  79.,
         66.,  59.,  54.,  43.,  20.,  33.,  18.,  19.,   9.,   9.],
       [  9.,  19.,  15.,  25.,  29.,  44.,  53.,  64.,  89., 102., 113.,
        152., 153., 145., 137., 131., 150., 155., 113., 102., 103.,  78.,
         87.,  69.,  58.,  35.,  44.,  26.,  18.,   9.,  11.,   5.],
       [ 15.,  12.,  17.,  24.,  30.,  52.,  53.,  80.,  86., 116., 139.,
        140., 132., 132., 143., 142., 147., 128., 106., 116.,  91.,  94.,
         69.,  72.,  53.,  34.,  38.,  20.,  12.,  21.,  11.,  11.],
       [ 12.,  15.,  13.,  21.,  22.,  56.,  67.,  67., 109.,  96., 108.,
        140., 119., 155., 132., 133., 156., 150., 120., 119.,  99.,  96.,
         72.,  66.,  63.,  46.,  35.,  28.,  23.,  15.,  16.,  12.],
       [ 13.,  11.,  23.,  19.,  42.,  44.,  59.,  81.,  93., 108., 124.,
        122., 129., 139., 142., 153., 144., 121., 121.,  99., 126.,  88.,
         73.,  65.,  55.,  40.,  26.,  24.,  25.,  14.,  14.,  16.],
       [ 14.,   9.,  15.,  28.,  30.,  39.,  57.,  68., 119., 112., 102.,
        116., 126., 132., 140., 132., 145., 145., 137., 121.,  95.,  90.,
         67.,  65.,  67.,  54.,  27.,  31.,  19.,  15.,  11.,  10.],
       [ 16.,  19.,  22.,  23.,  44.,  42.,  55.,  77.,  87., 108., 122.,
        121., 119., 152., 148., 139., 136., 127., 115., 119.,  97., 106.,
         76.,  66.,  51.,  32.,  41.,  24.,  25.,  26.,   9.,  14.],
       [ 10.,  17.,  16.,  28.,  30.,  47.,  45.,  64.,  68.,  96., 135.,
        116., 144., 137., 148., 139., 135., 142., 136., 111., 107., 101.,
         82.,  58.,  61.,  49.,  53.,  34.,  21.,  10.,  19.,  12.],
       [ 12.,  13.,  17.,  22.,  30.,  22.,  40.,  71.,  97.,  85., 118.,
        117., 124., 140., 132., 133., 144., 142., 103., 103., 128.,  92.,
         69.,  63.,  47.,  44.,  38.,  26.,  16.,  10.,  18.,  10.],
       [ 12.,  13.,   9.,  21.,  34.,  41.,  51.,  76.,  93., 123., 119.,
        134., 137., 137., 134., 139., 109., 146., 116., 116.,  89.,  92.,
         72.,  62.,  50.,  47.,  45.,  25.,  28.,  20.,  15.,  14.],
       [ 12.,  20.,  16.,  26.,  36.,  35.,  48.,  66., 102.,  87., 118.,
        130., 126., 146., 146., 133., 135., 126., 137., 108.,  91.,  83.,
         67.,  60.,  61.,  43.,  24.,  26.,  29.,  12.,  20.,   8.],
       [ 14.,  12.,  23.,  20.,  30.,  41.,  54.,  62.,  72., 100., 127.,
        117., 128., 143., 137., 143., 157., 143., 128., 109., 122.,  85.,
         60.,  69.,  47.,  43.,  27.,  20.,  20.,  26.,  20.,  10.],
       [ 14.,  16.,  17.,  30.,  41.,  42.,  44.,  81.,  85., 102., 122.,
        118., 131., 136., 128., 126., 135., 148.,  99.,  89., 106.,  89.,
         77.,  49.,  48.,  56.,  32.,  10.,  23.,  22.,  23.,  17.],
       [  9.,  11.,  19.,  19.,  31.,  43.,  46.,  77.,  95.,  90., 107.,
        131., 132., 126., 143., 149., 136., 112., 147., 107.,  82.,  81.,
         74.,  55.,  51.,  34.,  33.,  36.,  24.,  20.,  15.,   9.],
       [  6.,   9.,  16.,  12.,  28.,  36.,  65.,  65.,  82., 102.,  95.,
        125., 125., 140., 144., 149., 128., 106., 119., 110., 106.,  80.,
         65.,  63.,  52.,  46.,  39.,  28.,  24.,  16.,  12.,   5.],
       [ 10.,  13.,  16.,  23.,  17.,  39.,  44.,  72.,  88., 107., 120.,
        127., 121., 131., 128., 143., 129., 125., 121., 122., 117.,  74.,
         72.,  75.,  63.,  35.,  33.,  15.,  16.,  14.,  11.,  12.],
       [ 16.,  19.,  15.,  21.,  30.,  41.,  42.,  69.,  85., 109., 118.,
        108., 114., 144., 121., 143., 144., 122., 107., 124.,  86.,  98.,
         69.,  73.,  47.,  37.,  34.,  25.,  14.,  11.,  22.,  13.],
       [ 15.,  15.,  19.,  19.,  23.,  38.,  50.,  60.,  92., 107., 110.,
        129., 129., 143., 123., 141., 127., 115., 129.,  95.,  87.,  79.,
         65.,  50.,  58.,  24.,  41.,  20.,  14.,  13.,  10.,  10.],
       [ 13.,  10.,  12.,  26.,  22.,  39.,  63.,  50.,  85.,  99., 103.,
        130., 138., 119., 136., 146., 116., 136., 112.,  98.,  98.,  79.,
         75.,  68.,  43.,  45.,  23.,  25.,  17.,  17.,  16.,  10.],
       [ 10.,  13.,  10.,  19.,  23.,  36.,  51.,  78.,  76., 100., 105.,
        134., 122., 131., 141., 139., 109., 109., 108., 102.,  87., 104.,
         73.,  61.,  60.,  33.,  41.,  24.,  16.,   7.,  13.,  16.],
       [ 10.,  11.,  18.,  12.,  17.,  33.,  51.,  61.,  79.,  86., 126.,
        134., 146., 130., 121., 118., 134., 140., 115., 102., 105.,  90.,
         87.,  69.,  48.,  34.,  26.,  31.,  14.,  13.,  14.,  10.],
       [  8.,  14.,   8.,  17.,  39.,  59.,  51.,  69.,  76., 114., 108.,
        138., 129., 130., 124., 125., 126., 116., 134., 102.,  90.,  69.,
         70.,  47.,  48.,  42.,  34.,  43.,  17.,  16.,  16.,  11.],
       [ 15.,  12.,  17.,  21.,  32.,  37.,  48.,  75.,  69.,  99., 115.,
        122., 114., 130., 111., 123., 111., 113., 115., 101., 115.,  91.,
         72.,  66.,  54.,  49.,  31.,  23.,  21.,  15.,  11.,  13.],
       [ 11.,  14.,  15.,  24.,  31.,  32.,  51.,  67.,  88., 100., 101.,
        115., 117., 141., 138., 119., 141., 126., 125., 102.,  77.,  82.,
         59.,  67.,  58.,  42.,  22.,  29.,  24.,  19.,  12.,  12.],
       [ 15.,  11.,  17.,  24.,  27.,  51.,  56.,  56.,  75.,  88., 113.,
        140., 134., 155., 129., 133., 123., 121., 141.,  98.,  81.,  96.,
         75.,  65.,  48.,  48.,  28.,  24.,  14.,  18.,  12.,   4.],
       [ 11.,  15.,  15.,  19.,  28.,  29.,  52.,  62.,  91., 120.,  93.,
        129., 137., 109., 143., 138., 126., 127., 109.,  96.,  75.,  70.,
         72.,  59.,  47.,  35.,  22.,  25.,  11.,  21.,   9.,   8.],
       [ 13.,  12.,  13.,  23.,  22.,  47.,  41.,  62.,  77., 107., 111.,
        124., 125., 146., 133., 126., 131., 121., 101.,  79.,  79.,  91.,
         64.,  55.,  49.,  38.,  33.,  22.,  18.,  20.,  17.,   9.],
       [ 18.,  20.,  11.,  18.,  37.,  44.,  49.,  64.,  91.,  94., 102.,
        103., 126., 114., 137., 118., 107., 120., 104., 101., 107.,  76.,
         73.,  57.,  48.,  45.,  25.,  24.,  17.,  18.,   7.,  12.],
       [  8.,  13.,  13.,  28.,  30.,  23.,  49.,  73.,  81.,  95., 104.,
        120., 145., 135., 145., 138., 110., 126., 120., 108.,  74.,  91.,
         69.,  60.,  44.,  38.,  33.,  26.,  19.,  18.,  13.,  13.],
       [ 11.,   6.,  12.,  22.,  29.,  41.,  48.,  66.,  65.,  91.,  98.,
        119., 124., 141., 144., 130., 124., 108., 115., 110.,  71.,  81.,
         71.,  77.,  53.,  39.,  36.,  19.,  22.,  15.,  13.,  11.],
       [ 10.,  13.,  12.,  15.,  27.,  31.,  47.,  51.,  66.,  83., 101.,
        133., 123., 148., 136., 104., 132., 122., 110., 106.,  76.,  77.,
         75.,  61.,  54.,  39.,  29.,  32.,  19.,  16.,  13.,  10.],
       [ 13.,  12.,  17.,  18.,  27.,  53.,  67.,  64.,  75.,  89., 110.,
        133., 120., 141., 128., 119., 134., 121., 114.,  89.,  93.,  97.,
         65.,  61.,  41.,  42.,  37.,  32.,  12.,  10.,  18.,   7.],
       [ 11.,  14.,  21.,  23.,  28.,  28.,  53.,  58.,  68.,  89., 114.,
        103., 111., 124., 126., 122., 103., 125., 102.,  97.,  87.,  82.,
         54.,  54.,  49.,  28.,  31.,  31.,  12.,  21.,   9.,   9.],
       [ 14.,  10.,  12.,  23.,  28.,  32.,  55.,  52.,  74., 104.,  90.,
        102., 115., 129., 136., 123., 133., 116.,  98., 110.,  82.,  71.,
         72.,  64.,  46.,  29.,  16.,  27.,  22.,  16.,  14.,  10.],
       [ 14.,  10.,  19.,  20.,  26.,  42.,  50.,  67.,  68.,  95.,  95.,
        122., 119., 139., 113., 126., 118., 115.,  96.,  93.,  84.,  71.,
         60.,  52.,  35.,  38.,  33.,  20.,  15.,  21.,  12.,  15.],
       [ 11.,   7.,   8.,  21.,  36.,  35.,  54.,  67.,  71., 102., 111.,
        112., 132., 129., 127., 128., 130., 130., 130.,  94.,  77.,  67.,
         83.,  52.,  41.,  39.,  24.,  24.,  18.,  17.,  11.,   7.],
       [ 10.,   9.,  19.,  16.,  30.,  32.,  60.,  63.,  83.,  72., 105.,
        126., 130., 114., 126., 114., 115., 108.,  85., 106.,  87.,  84.,
         59.,  68.,  53.,  27.,  32.,  23.,  11.,  20.,  16.,  11.],
       [ 12.,  13.,  20.,  17.,  33.,  38.,  49.,  76.,  70.,  87., 102.,
        128., 130., 139., 114., 131., 110., 140., 107.,  97.,  76.,  80.,
         73.,  60.,  39.,  36.,  25.,  24.,  13.,  18.,  15.,   8.],
       [ 13.,  14.,  18.,  13.,  23.,  49.,  48.,  63.,  77.,  85., 121.,
        114., 106., 102., 103., 118., 100., 108., 109.,  81.,  80.,  67.,
         62.,  44.,  41.,  41.,  31.,  24.,  20.,   8.,  10.,  11.],
       [ 12.,   7.,  16.,  18.,  24.,  34.,  53.,  58.,  63.,  94., 111.,
        119., 105., 120., 127., 113., 118., 100., 104.,  88.,  70.,  76.,
         56.,  39.,  50.,  32.,  24.,  20.,  21.,   9.,   4.,   8.],
       [ 14.,  21.,  15.,  20.,  28.,  40.,  52.,  45.,  71., 106.,  83.,
        103., 110., 135., 125., 108., 106., 103., 107.,  80.,  86.,  70.,
         75.,  43.,  51.,  23.,  25.,  23.,  23.,  14.,  15.,  18.],
       [ 14.,   5.,  18.,  13.,  33.,  46.,  50.,  62.,  75.,  83., 109.,
        120., 112., 130., 127., 110., 133., 135., 103.,  89.,  85.,  73.,
         66.,  60.,  51.,  41.,  34.,  19.,  15.,  16.,   7.,  11.],
       [ 17.,   8.,  19.,  21.,  31.,  33.,  45.,  67.,  77., 113., 112.,
        100., 132., 125., 106., 121., 113.,  97., 116.,  92.,  84.,  65.,
         71.,  45.,  41.,  37.,  27.,  19.,  20.,  14.,  13.,   8.],
       [ 14.,  11.,  15.,  22.,  10.,  35.,  49.,  67.,  71.,  89.,  95.,
         91., 123., 121., 122., 124., 112., 113.,  98.,  93.,  76.,  78.,
         55.,  42.,  38.,  36.,  26.,  27.,  15.,  16.,  10.,   6.],
       [  8.,  11.,   8.,  26.,  38.,  36.,  43.,  67.,  73.,  84.,  96.,
        124., 125., 126., 118., 125., 100., 108.,  94.,  71.,  72.,  56.,
         65.,  58.,  38.,  37.,  24.,  29.,  20.,  13.,   9.,   5.],
       [  6.,  13.,  13.,  15.,  24.,  32.,  55.,  60.,  66.,  89.,  85.,
        108., 109., 104.,  95.,  97., 107., 122., 107.,  89.,  80.,  71.,
         69.,  54.,  43.,  30.,  22.,  20.,  17.,   6.,  17.,  12.],
       [  6.,  10.,  24.,  26.,  24.,  30.,  43.,  67.,  75.,  90., 102.,
        115., 141., 114., 112., 107., 129., 104., 101.,  94.,  72.,  58.,
         58.,  36.,  41.,  36.,  25.,  22.,  17.,  21.,  12.,   8.],
       [  8.,  14.,  19.,  21.,  38.,  40.,  50.,  64.,  65.,  86.,  96.,
        120., 121., 113., 104., 109., 104., 103., 101.,  88.,  98.,  61.,
         70.,  48.,  38.,  45.,  30.,  18.,  14.,  17.,   5.,   9.],
       [  5.,  12.,  15.,  18.,  21.,  47.,  44.,  61.,  63., 101.,  94.,
        104., 117., 117., 130., 108., 114., 111.,  82.,  84.,  75.,  69.,
         53.,  42.,  36.,  31.,  27.,  20.,  12.,   9.,  11.,   9.],
       [ 14.,  14.,  16.,  26.,  26.,  30.,  46.,  67.,  76.,  87.,  97.,
        103., 132., 115., 114., 118., 116., 114., 106.,  84.,  68.,  64.,
         59.,  49.,  44.,  40.,  20.,  24.,  11.,  11.,  12.,  14.],
       [  9.,  15.,  21.,  18.,  25.,  34.,  33.,  73.,  75., 103.,  98.,
        113., 107., 114., 111., 113., 134., 120.,  85.,  97.,  81.,  75.,
         62.,  59.,  36.,  48.,  19.,  21.,  14.,  15.,   6.,   8.],
       [  8.,   9.,  14.,  16.,  37.,  29.,  34.,  43.,  85.,  80., 106.,
        117., 113., 112., 134., 124., 102., 111., 111.,  73.,  80.,  75.,
         76.,  55.,  33.,  30.,  24.,  27.,  19.,  13.,  11.,  12.],
       [ 11.,   8.,   9.,  16.,  27.,  32.,  32.,  56.,  75.,  95.,  99.,
        129., 118., 108., 117., 100., 107., 126., 103.,  89.,  76.,  63.,
         60.,  48.,  38.,  37.,  29.,  19.,  18.,  11.,  15.,  19.],
       [  8.,   7.,  13.,  18.,  25.,  37.,  49.,  64.,  65.,  88.,  90.,
        111., 122., 110., 114., 116., 121.,  89.,  95., 102.,  65.,  64.,
         63.,  56.,  53.,  32.,  22.,  23.,  16.,  11.,  13.,   8.],
       [ 14.,  15.,  13.,  19.,  28.,  21.,  41.,  64.,  72.,  95.,  95.,
        104., 111., 118., 111.,  94., 106., 101.,  98.,  84.,  67.,  68.,
         54.,  56.,  38.,  30.,  27.,  22.,  16.,   9.,   7.,  17.],
       [  7.,   9.,  14.,  20.,  32.,  35.,  45.,  72.,  65.,  90.,  81.,
         94., 113., 109., 114., 118., 107.,  99., 112.,  84.,  79.,  52.,
         57.,  53.,  54.,  36.,  30.,  13.,  14.,  11.,   9.,   7.],
       [  6.,  11.,   9.,  10.,  28.,  36.,  43.,  62.,  81.,  81.,  95.,
        143., 115., 123., 115., 113., 109., 107., 101.,  80.,  72.,  63.,
         44.,  48.,  44.,  30.,  22.,  19.,  16.,   9.,   8.,   8.],
       [ 16.,   6.,  20.,  17.,  20.,  25.,  49.,  65.,  61.,  91.,  85.,
         79., 124., 107., 118.,  98., 104.,  88., 104.,  79.,  82.,  54.,
         49.,  53.,  42.,  25.,  26.,  26.,  10.,  11.,  10.,  10.],
       [  4.,   8.,  12.,  18.,  21.,  25.,  47.,  52.,  72.,  73.,  84.,
        106., 108., 107., 111., 103., 101.,  98.,  97.,  93.,  82.,  70.,
         56.,  52.,  34.,  37.,  28.,  24.,  14.,  13.,  10.,   9.],
       [  8.,  11.,   9.,  20.,  23.,  37.,  47.,  56.,  60.,  81., 101.,
        102.,  98.,  90., 116., 120., 110., 112.,  96.,  87.,  66.,  58.,
         62.,  46.,  46.,  41.,  21.,  23.,  14.,  10.,   7.,  10.],
       [  8.,  10.,  10.,  17.,  21.,  29.,  48.,  51.,  72.,  73.,  89.,
         95., 106., 102., 117.,  84., 113.,  89., 107.,  93.,  69.,  55.,
         56.,  64.,  55.,  40.,  30.,  23.,  19.,  14.,   8.,   7.],
       [ 11.,  12.,  21.,  14.,  20.,  47.,  30.,  48.,  72.,  58.,  77.,
        108., 107., 116., 101., 115., 118.,  66.,  76.,  85.,  88.,  63.,
         56.,  48.,  41.,  23.,  29.,  27.,  15.,  14.,  13.,  10.],
       [  8.,   8.,   8.,  17.,  37.,  28.,  41.,  59.,  66.,  75.,  84.,
        125., 112., 103.,  99., 122., 111., 100.,  94.,  98.,  73.,  63.,
         52.,  36.,  41.,  27.,  22.,  19.,  15.,  11.,  11.,   8.],
       [  7.,  13.,  11.,  18.,  37.,  39.,  49.,  42.,  78.,  77., 110.,
        104., 104.,  87.,  93.,  99.,  93., 104., 101.,  88.,  83.,  52.,
         40.,  40.,  34.,  28.,  29.,  21.,  11.,  11.,   5.,   6.],
       [  5.,   7.,  12.,  17.,  29.,  31.,  42.,  49.,  81.,  81.,  88.,
         86.,  95.,  93.,  95.,  90., 108.,  92.,  90.,  91.,  72.,  47.,
         45.,  51.,  35.,  35.,  26.,  17.,  17.,  17.,   6.,   9.],
       [  5.,  12.,  10.,  12.,  30.,  28.,  63.,  48.,  72.,  83.,  97.,
         97., 120., 118., 108., 113.,  99.,  86.,  83.,  77.,  75.,  59.,
         41.,  52.,  39.,  27.,  21.,  17.,  22.,   6.,   8.,  12.],
       [ 11.,   9.,  13.,  18.,  20.,  38.,  43.,  54.,  58.,  67.,  71.,
         91., 104.,  95., 103., 102.,  77.,  98.,  96.,  81.,  77.,  62.,
         58.,  38.,  36.,  34.,  23.,  16.,  12.,   7.,   8.,   3.],
       [  5.,  15.,  11.,  23.,  20.,  27.,  49.,  47.,  72.,  77.,  93.,
        105.,  92., 101., 108., 110., 115.,  93.,  90.,  88.,  73.,  66.,
         56.,  43.,  31.,  37.,  27.,  17.,  12.,   9.,  10.,   9.],
       [  8.,  10.,  19.,  17.,  22.,  32.,  42.,  44.,  71.,  83.,  77.,
        104.,  96.,  97., 104., 101., 109.,  95.,  97.,  66.,  67.,  53.,
         53.,  40.,  27.,  36.,  29.,  26.,  17.,  11.,   8.,   4.],
       [  4.,  15.,  14.,  18.,  17.,  26.,  42.,  73.,  51.,  79.,  84.,
         83.,  92., 109., 122.,  95., 107.,  91.,  81.,  63.,  71.,  64.,
         50.,  39.,  40.,  26.,  27.,  19.,  12.,  11.,  15.,  13.],
       [  6.,   7.,  18.,  17.,  28.,  35.,  50.,  46.,  68.,  90.,  88.,
         96.,  94.,  88.,  96., 123., 103.,  88.,  72.,  85.,  61.,  69.,
         60.,  41.,  44.,  32.,  22.,  20.,  20.,   6.,  12.,   7.],
       [ 12.,   7.,  15.,  20.,  30.,  32.,  42.,  59.,  61.,  74.,  88.,
        104.,  97., 105., 107.,  88.,  86.,  94.,  92.,  74.,  71.,  61.,
         49.,  34.,  30.,  27.,  25.,  14.,  13.,   6.,  15.,   9.],
       [ 10.,  13.,  16.,  13.,  19.,  29.,  33.,  47.,  68.,  68.,  82.,
         87., 102.,  99.,  88., 107., 106.,  89.,  73.,  57.,  69.,  61.,
         69.,  39.,  44.,  39.,  23.,  15.,  11.,  14.,   5.,  14.],
       [  8.,   8.,   8.,   6.,  20.,  26.,  41.,  60.,  70.,  76.,  93.,
        105., 110.,  89., 114.,  84.,  92.,  81.,  82.,  86.,  58.,  67.,
         65.,  45.,  34.,  25.,  29.,  17.,  18.,  15.,  13.,  12.],
       [  9.,  10.,  20.,  11.,  17.,  22.,  34.,  66.,  62.,  75., 110.,
         83., 100.,  89.,  97., 104.,  84.,  80.,  81.,  64.,  77.,  64.,
         42.,  42.,  40.,  30.,  19.,  17.,  13.,  10.,   4.,  10.],
       [  3.,  10.,   8.,  16.,  21.,  33.,  38.,  72.,  55.,  80.,  73.,
         85.,  92., 107., 101., 101.,  95., 101.,  77.,  83.,  62.,  62.,
         58.,  52.,  27.,  39.,  27.,  24.,  12.,  13.,   4.,   8.],
       [ 10.,  11.,  10.,  17.,  15.,  32.,  37.,  47.,  59.,  71.,  88.,
        102.,  96.,  92.,  99.,  96.,  94.,  83.,  91.,  58.,  69.,  53.,
         53.,  33.,  27.,  27.,  20.,  22.,   9.,   7.,   4.,   7.],
       [  5.,   9.,   8.,  14.,  16.,  27.,  46.,  45.,  54.,  95.,  71.,
         95.,  97., 106.,  97.,  89., 101.,  92.,  70.,  71.,  70.,  53.,
         41.,  43.,  37.,  22.,  21.,  17.,  14.,  13.,   9.,   7.],
       [ 15.,  11.,   8.,  15.,  15.,  31.,  39.,  60.,  67.,  67.,  74.,
         96.,  98.,  92.,  95.,  89.,  78.,  87.,  89.,  72.,  59.,  54.,
         36.,  50.,  42.,  27.,  20.,  19.,  16.,  14.,   6.,   7.],
       [  9.,  14.,  14.,  12.,  19.,  38.,  50.,  52.,  70.,  80.,  84.,
        108.,  79.,  90.,  97., 109.,  95.,  72.,  85.,  79.,  52.,  61.,
         53.,  44.,  33.,  31.,  19.,  17.,  14.,   9.,  10.,   5.],
       [  7.,   7.,  21.,  19.,  25.,  30.,  25.,  54.,  58.,  74.,  76.,
         91.,  97., 100.,  80.,  94.,  82., 100.,  81.,  66.,  63.,  64.,
         55.,  48.,  34.,  36.,  23.,  25.,  11.,  11.,   6.,   5.],
       [  9.,   6.,  14.,  15.,  21.,  33.,  38.,  53.,  68.,  68.,  87.,
         81.,  84.,  95., 123.,  84.,  91.,  98.,  65.,  66.,  53.,  43.,
         65.,  28.,  26.,  30.,  21.,  17.,  15.,  10.,  11.,   7.],
       [ 11.,   8.,  12.,  13.,  18.,  25.,  40.,  58.,  63.,  74.,  69.,
         81.,  92.,  87.,  92.,  83.,  98.,  91.,  73.,  77.,  47.,  52.,
         61.,  36.,  30.,  26.,  20.,  15.,  15.,  14.,   6.,   3.],
       [  6.,   9.,  12.,  17.,  19.,  26.,  46.,  48.,  49.,  70.,  70.,
         98.,  89.,  99., 103.,  90.,  83.,  57.,  71.,  70.,  67.,  52.,
         44.,  44.,  23.,  24.,  22.,  21.,   8.,   5.,   7.,   8.],
       [  6.,  10.,   9.,  22.,  23.,  29.,  36.,  47.,  57.,  83.,  89.,
         78.,  81.,  97., 101., 102.,  83.,  83.,  75.,  72.,  58.,  62.,
         48.,  38.,  28.,  36.,  15.,  10.,  14.,  10.,   7.,   4.],
       [  7.,  11.,  11.,  20.,  23.,  27.,  42.,  53.,  65.,  65.,  85.,
        105.,  86., 112.,  86.,  87.,  88.,  90.,  69.,  66.,  59.,  60.,
         54.,  44.,  42.,  32.,  27.,  20.,  11.,  12.,   7.,   7.],
       [  5.,   6.,  12.,  15.,  22.,  30.,  40.,  54.,  63.,  75.,  83.,
         91.,  92., 103., 101., 100.,  84.,  84.,  79.,  44.,  40.,  56.,
         54.,  49.,  32.,  26.,  23.,  20.,  15.,   9.,   1.,   7.],
       [  5.,   7.,   6.,   9.,  21.,  27.,  39.,  56.,  59.,  56.,  82.,
         89.,  87.,  80.,  83.,  86.,  90.,  87.,  80.,  68.,  56.,  69.,
         37.,  37.,  34.,  18.,  20.,  18.,  12.,  14.,   5.,   5.],
       [  7.,   5.,  11.,  21.,  15.,  34.,  31.,  35.,  68.,  83.,  67.,
         89., 101.,  92.,  96.,  93.,  90.,  88.,  67.,  78.,  50.,  55.,
         36.,  38.,  29.,  26.,  21.,  14.,  11.,  12.,   8.,   6.],
       [ 10.,   6.,  12.,  15.,  22.,  30.,  42.,  48.,  56.,  69.,  73.,
         87.,  83.,  84., 107.,  96.,  83.,  68.,  84.,  70.,  56.,  51.,
         42.,  34.,  28.,  25.,  23.,  15.,  12.,   7.,   7.,   8.],
       [ 10.,  10.,  14.,  17.,  17.,  31.,  32.,  47.,  47.,  64.,  80.,
         96.,  81.,  87.,  83.,  74.,  88.,  88.,  64.,  63.,  51.,  46.,
         58.,  45.,  36.,  34.,  24.,  13.,  16.,   6.,   9.,  10.],
       [  7.,   9.,  16.,  21.,  22.,  28.,  29.,  53.,  49.,  63.,  79.,
         81.,  77.,  86.,  86.,  87.,  85.,  77.,  79.,  47.,  57.,  39.,
         51.,  39.,  28.,  25.,  25.,  14.,   8.,  15.,   4.,   6.],
       [ 11.,   9.,  13.,  12.,  22.,  13.,  32.,  48.,  62.,  72.,  83.,
         86.,  90.,  82.,  84., 108.,  87.,  62.,  95.,  67.,  45.,  52.,
         51.,  39.,  25.,  23.,  26.,  16.,  14.,  11.,  16.,   9.],
       [  8.,   6.,  13.,  11.,  19.,  27.,  40.,  41.,  69.,  68.,  66.,
         80.,  85.,  89.,  76., 100.,  70.,  76.,  65.,  68.,  61.,  50.,
         45.,  40.,  40.,  26.,  25.,  12.,  10.,   7.,   7.,  11.],
       [  9.,  14.,  13.,  15.,  18.,  33.,  42.,  50.,  59.,  61.,  78.,
         77.,  95.,  83.,  89.,  85.,  84.,  86.,  72.,  60.,  53.,  47.,
         35.,  40.,  21.,  28.,  21.,  23.,  19.,  11.,   9.,   8.],
       [  5.,  14.,  13.,  17.,  20.,  32.,  38.,  49.,  61.,  64.,  66.,
         86.,  80.,  91.,  95.,  85.,  88.,  75.,  62.,  49.,  73.,  39.,
         33.,  40.,  40.,  23.,  23.,  16.,   7.,   7.,   6.,   8.],
       [ 11.,   7.,   7.,  14.,  18.,  21.,  32.,  45.,  57.,  61.,  75.,
         79.,  68., 101., 104.,  92.,  84.,  77.,  76.,  64.,  48.,  41.,
         56.,  35.,  29.,  30.,  18.,  11.,   6.,   7.,  11.,   7.],
       [ 11.,  15.,   7.,  22.,  16.,  33.,  35.,  29.,  51.,  60.,  72.,
         88., 104.,  85.,  74.,  71.,  77.,  62.,  73.,  83.,  60.,  43.,
         41.,  42.,  38.,  22.,  18.,  19.,  12.,   8.,  12.,   4.],
       [  5.,   5.,   8.,  13.,  18.,  21.,  45.,  34.,  49.,  61.,  74.,
         62.,  98.,  91.,  99.,  83.,  72.,  71.,  70.,  66.,  46.,  47.,
         42.,  46.,  23.,  30.,  22.,  14.,  14.,   7.,   8.,   5.],
       [  5.,   9.,  16.,  15.,  14.,  29.,  35.,  53.,  49.,  78.,  78.,
         80.,  97., 111.,  91.,  94.,  83.,  87.,  66.,  51.,  49.,  45.,
         41.,  41.,  31.,  22.,  15.,  14.,  13.,   7.,   7.,   3.],
       [  8.,   7.,  10.,  16.,  21.,  28.,  48.,  52.,  46.,  67.,  67.,
         64.,  75.,  65.,  89.,  74.,  77.,  92.,  66.,  62.,  67.,  54.,
         42.,  38.,  36.,  13.,  14.,  12.,  12.,   5.,   8.,  10.],
       [  4.,   9.,  15.,  10.,  17.,  24.,  37.,  52.,  48.,  72.,  67.,
         61.,  90.,  89.,  78.,  73.,  73.,  66.,  70.,  64.,  61.,  56.,
         46.,  32.,  32.,  28.,  17.,  17.,   8.,   7.,   8.,   5.],
       [ 11.,  11.,   8.,  18.,  24.,  22.,  35.,  54.,  45.,  53.,  85.,
         80.,  83.,  93.,  77., 106.,  88.,  49.,  66.,  59.,  61.,  54.,
         41.,  30.,  35.,  19.,  18.,  17.,  11.,  10.,   9.,   8.],
       [  4.,   5.,  12.,  13.,  14.,  18.,  29.,  54.,  49.,  56.,  67.,
         81.,  92.,  73.,  81.,  75.,  87.,  55.,  83.,  68.,  60.,  48.,
         34.,  31.,  31.,  28.,  16.,  13.,  10.,   7.,  11.,   8.],
       [  5.,  11.,  13.,  14.,  16.,  31.,  28.,  43.,  58.,  54.,  78.,
         71.,  88.,  90.,  70.,  74.,  82.,  59.,  58.,  66.,  37.,  56.,
         37.,  30.,  33.,  23.,  17.,  18.,   8.,  10.,   6.,   5.],
       [  2.,   6.,  10.,  21.,  18.,  26.,  36.,  44.,  55.,  47.,  77.,
         72.,  85.,  81.,  94.,  73.,  82.,  64.,  65.,  51.,  56.,  54.,
         46.,  38.,  24.,  23.,  16.,  10.,   7.,  13.,  11.,   2.],
       [  6.,   4.,  13.,  24.,  18.,  26.,  38.,  46.,  50.,  72.,  70.,
         86.,  72.,  83.,  73.,  72.,  65.,  52.,  63.,  47.,  49.,  44.,
         38.,  32.,  26.,  22.,  25.,  12.,  10.,   8.,   6.,  10.],
       [  7.,   3.,   6.,  12.,  18.,  30.,  31.,  38.,  36.,  72.,  75.,
         77.,  83.,  68.,  82.,  87.,  74.,  65.,  62.,  63.,  42.,  44.,
         34.,  29.,  23.,  21.,  18.,  15.,  11.,  10.,   5.,   8.],
       [  4.,   6.,  14.,  16.,  17.,  30.,  23.,  30.,  53.,  68.,  50.,
         89.,  73.,  68.,  77.,  73.,  60.,  71.,  57.,  68.,  45.,  40.,
         25.,  28.,  26.,  18.,  18.,  10.,  14.,   7.,  13.,   8.],
       [ 10.,   5.,   4.,  18.,  15.,  23.,  31.,  45.,  43.,  63.,  59.,
         66.,  72.,  79.,  73.,  62.,  87.,  67.,  66.,  47.,  49.,  40.,
         34.,  24.,  34.,  30.,  17.,  14.,  12.,  10.,  12.,   5.],
       [  9.,   5.,  11.,  12.,  24.,  29.,  34.,  49.,  54.,  63.,  57.,
         70.,  63.,  83.,  73.,  84.,  65.,  56.,  61.,  50.,  50.,  52.,
         47.,  36.,  24.,  23.,  12.,  11.,   7.,   7.,   5.,   8.],
       [  7.,   8.,   7.,  12.,  19.,  19.,  28.,  36.,  45.,  44.,  75.,
         58.,  85.,  88.,  76.,  91.,  76.,  56.,  66.,  67.,  48.,  55.,
         31.,  36.,  32.,  26.,  21.,  14.,  12.,  10.,  11.,   7.],
       [  5.,   5.,   7.,   9.,  13.,  30.,  32.,  41.,  44.,  72.,  59.,
         76.,  84.,  74.,  82.,  73.,  88.,  81.,  65.,  62.,  52.,  33.,
         40.,  30.,  24.,  22.,  16.,  16.,   6.,   6.,   6.,   4.],
       [  7.,  11.,  13.,  15.,  22.,  23.,  35.,  30.,  45.,  62.,  74.,
         82.,  83.,  68.,  67.,  93.,  75.,  58.,  75.,  55.,  42.,  36.,
         39.,  37.,  21.,  14.,  15.,  21.,  11.,  12.,   7.,   4.],
       [  7.,   9.,   5.,  15.,  16.,  20.,  37.,  42.,  44.,  49.,  58.,
         69.,  85.,  90.,  87.,  80.,  61.,  61.,  52.,  56.,  47.,  39.,
         33.,  37.,  26.,  17.,  17.,  11.,  11.,   6.,   9.,   8.],
       [  8.,  10.,   9.,  22.,  22.,  22.,  36.,  43.,  49.,  71.,  63.,
         82.,  62.,  77.,  95.,  78.,  74.,  50.,  55.,  44.,  54.,  39.,
         36.,  33.,  35.,  17.,  16.,  15.,  17.,  13.,   7.,   6.],
       [  7.,   4.,  10.,  11.,  13.,  32.,  20.,  36.,  50.,  62.,  58.,
         62.,  73.,  87.,  73.,  86.,  69.,  73.,  58.,  40.,  41.,  43.,
         50.,  31.,  27.,  24.,  15.,  17.,  13.,   8.,   5.,   3.],
       [ 10.,   5.,   1.,  13.,  17.,  27.,  40.,  37.,  61.,  48.,  55.,
         83.,  73.,  67.,  59.,  75.,  65.,  57.,  54.,  67.,  42.,  46.,
         48.,  33.,  16.,  19.,  14.,  19.,  14.,   9.,  10.,  11.],
       [  7.,  10.,   8.,  14.,  19.,  21.,  38.,  45.,  53.,  52.,  55.,
         67.,  82.,  81.,  52.,  76.,  59.,  63.,  64.,  58.,  61.,  41.,
         34.,  25.,  22.,  19.,  24.,  15.,  14.,   7.,   8.,  10.],
       [  8.,   6.,   4.,   7.,  16.,  21.,  30.,  36.,  49.,  63.,  63.,
         65.,  74.,  72.,  93.,  84.,  73.,  52.,  62.,  51.,  56.,  34.,
         40.,  23.,  14.,  17.,   8.,  10.,   5.,   5.,  10.,   9.],
       [ 12.,   9.,   9.,  16.,  20.,  31.,  32.,  42.,  50.,  44.,  59.,
         72.,  80.,  76.,  71.,  72.,  67.,  54.,  51.,  59.,  41.,  38.,
         40.,  27.,  27.,  11.,  16.,  18.,   7.,   6.,   5.,   9.],
       [  3.,   9.,  10.,   8.,  13.,  25.,  27.,  48.,  38.,  50.,  46.,
         54.,  76.,  77.,  74.,  63.,  88.,  65.,  70.,  72.,  54.,  33.,
         29.,  29.,  17.,  18.,  14.,  12.,   6.,   9.,   9.,   6.],
       [  4.,  10.,   5.,  12.,  18.,  26.,  27.,  35.,  44.,  75.,  60.,
         89.,  65.,  77.,  78.,  63.,  71.,  65.,  59.,  52.,  44.,  48.,
         41.,  27.,  23.,  16.,  23.,   9.,   9.,  10.,   7.,   7.],
       [  6.,   6.,   8.,  13.,  16.,  22.,  24.,  38.,  49.,  54.,  64.,
         77.,  77.,  81.,  82.,  70.,  69.,  50.,  51.,  59.,  34.,  46.,
         30.,  27.,  25.,  16.,  15.,  12.,   9.,  11.,   8.,   7.],
       [  7.,   7.,   8.,  13.,  18.,  28.,  33.,  24.,  41.,  58.,  64.,
         63.,  68.,  81.,  60.,  68.,  66.,  55.,  61.,  62.,  47.,  42.,
         43.,  45.,  23.,  20.,  14.,  16.,   6.,  12.,   7.,   7.],
       [  5.,   5.,   4.,  16.,  17.,  31.,  25.,  48.,  36.,  60.,  69.,
         69.,  69.,  58.,  78.,  69.,  64.,  57.,  48.,  49.,  36.,  37.,
         36.,  30.,  21.,  18.,  13.,   7.,  11.,  11.,   8.,   9.],
       [  6.,   6.,   9.,   7.,  12.,  16.,  28.,  39.,  45.,  59.,  79.,
         63.,  59.,  73.,  64.,  66.,  62.,  52.,  56.,  61.,  49.,  43.,
         32.,  37.,  20.,  20.,  17.,   8.,  14.,   6.,   4.,   8.],
       [  9.,   7.,  10.,   7.,  16.,  22.,  24.,  53.,  60.,  48.,  58.,
         68.,  58.,  72.,  68.,  67.,  59.,  63.,  52.,  52.,  52.,  39.,
         37.,  22.,  33.,  20.,  15.,  14.,   3.,  10.,   9.,   7.],
       [  6.,   8.,  10.,  10.,  15.,  19.,  40.,  43.,  51.,  50.,  67.,
         68.,  63.,  77.,  64.,  58.,  72.,  58.,  65.,  39.,  38.,  39.,
         42.,  21.,  21.,  19.,  20.,  15.,   6.,   5.,   6.,   5.],
       [  8.,   5.,   4.,  10.,  12.,  22.,  27.,  34.,  45.,  54.,  53.,
         61.,  61.,  80.,  71.,  71.,  74.,  66.,  64.,  49.,  43.,  46.,
         40.,  25.,  21.,  16.,  17.,   9.,   9.,   8.,   3.,   5.],
       [  4.,   7.,   8.,  10.,  14.,  30.,  34.,  38.,  52.,  50.,  47.,
         59.,  88.,  77.,  73.,  71.,  48.,  59.,  59.,  46.,  30.,  41.,
         25.,  24.,  24.,  23.,  12.,   9.,   9.,   5.,   5.,   6.],
       [  8.,  11.,   8.,  14.,  17.,  20.,  28.,  28.,  47.,  66.,  61.,
         69.,  65.,  74.,  64.,  73.,  59.,  56.,  59.,  60.,  46.,  36.,
         41.,  31.,  24.,  23.,  13.,  11.,   7.,   5.,   2.,   4.],
       [  5.,   5.,   8.,  12.,  17.,  16.,  41.,  38.,  50.,  52.,  59.,
         69.,  56.,  66.,  72.,  65.,  61.,  65.,  61.,  50.,  57.,  37.,
         25.,  26.,  18.,  20.,  13.,  12.,  13.,   8.,   6.,   7.],
       [  3.,   4.,   6.,  21.,  10.,  20.,  24.,  29.,  56.,  48.,  52.,
         59.,  53.,  81.,  64.,  61.,  68.,  58.,  62.,  41.,  46.,  29.,
         37.,  28.,  22.,  22.,  20.,  22.,   8.,  12.,   4.,   8.],
       [  7.,   5.,   7.,  13.,  12.,  24.,  38.,  44.,  41.,  50.,  70.,
         68.,  61.,  53.,  68.,  59.,  58.,  37.,  58.,  60.,  41.,  29.,
         30.,  30.,  19.,  11.,  14.,   8.,  11.,   8.,   8.,   2.],
       [  5.,   9.,  10.,  13.,  16.,  19.,  22.,  44.,  38.,  61.,  65.,
         55.,  63.,  56.,  66.,  60.,  68.,  54.,  45.,  57.,  37.,  39.,
         32.,  41.,  28.,  21.,   8.,  10.,  12.,  11.,   8.,   4.],
       [  5.,   5.,  12.,  17.,  18.,  13.,  23.,  41.,  34.,  45.,  66.,
         68.,  67.,  58.,  74.,  64.,  62.,  51.,  42.,  42.,  41.,  46.,
         27.,  32.,  24.,  19.,  21.,   9.,   5.,   5.,   7.,   4.],
       [ 10.,   2.,   6.,  13.,  15.,  27.,  27.,  31.,  37.,  43.,  56.,
         47.,  61.,  78.,  58.,  62.,  65.,  55.,  60.,  44.,  33.,  28.,
         27.,  19.,  20.,  20.,   9.,   8.,   7.,   5.,   7.,   5.],
       [  5.,  10.,   6.,   4.,  10.,  24.,  22.,  33.,  36.,  56.,  58.,
         67.,  76.,  76.,  67.,  58.,  64.,  45.,  47.,  40.,  40.,  32.,
         33.,  22.,  17.,  20.,  11.,   3.,  11.,   6.,   4.,   3.],
       [  9.,   6.,   8.,  15.,  14.,  15.,  31.,  39.,  40.,  55.,  60.,
         57.,  57.,  70.,  64.,  72.,  62.,  64.,  47.,  58.,  37.,  36.,
         34.,  21.,  19.,  22.,  14.,  11.,   5.,   5.,   3.,   4.],
       [  0.,   6.,  10.,  11.,  15.,  21.,  26.,  34.,  42.,  55.,  51.,
         77.,  71.,  65.,  65.,  51.,  56.,  49.,  50.,  45.,  43.,  37.,
         22.,  15.,  18.,  16.,  14.,   9.,   6.,   4.,   3.,   5.],
       [  4.,   5.,  11.,  12.,  14.,  13.,  22.,  28.,  46.,  46.,  53.,
         61.,  65.,  45.,  76.,  70.,  48.,  62.,  49.,  39.,  29.,  32.,
         27.,  32.,  16.,  17.,  10.,   8.,   7.,   8.,   3.,   3.],
       [  6.,   1.,  13.,   9.,  13.,  14.,  17.,  40.,  41.,  48.,  48.,
         49.,  61.,  77.,  79.,  65.,  55.,  46.,  45.,  47.,  45.,  34.,
         30.,  25.,  20.,  19.,  17.,  14.,   9.,   6.,   9.,  10.],
       [  5.,   7.,   7.,  14.,  17.,  20.,  24.,  29.,  34.,  37.,  47.,
         48.,  49.,  60.,  67.,  59.,  56.,  41.,  51.,  42.,  41.,  30.,
         34.,  22.,  23.,  19.,  15.,   7.,   5.,   3.,   9.,   3.],
       [  4.,   5.,   6.,  12.,  16.,  22.,  32.,  34.,  45.,  52.,  67.,
         60.,  63.,  54.,  71.,  53.,  58.,  49.,  47.,  43.,  31.,  32.,
         30.,  22.,  27.,  21.,  10.,  12.,   5.,   7.,   7.,   8.],
       [  5.,   4.,   4.,  12.,  14.,  28.,  31.,  26.,  35.,  46.,  48.,
         55.,  59.,  61.,  54.,  61.,  43.,  60.,  47.,  41.,  37.,  36.,
         20.,  20.,  21.,  28.,  14.,  14.,   8.,   6.,   7.,   4.],
       [  1.,   4.,   8.,   4.,  13.,  23.,  23.,  32.,  44.,  52.,  50.,
         48.,  46.,  60.,  51.,  60.,  49.,  58.,  57.,  45.,  35.,  36.,
         30.,  20.,  19.,  19.,  12.,  14.,   6.,  11.,   5.,   5.],
       [  4.,   6.,   8.,   7.,  13.,  19.,  18.,  26.,  45.,  50.,  59.,
         46.,  68.,  61.,  64.,  62.,  64.,  56.,  46.,  33.,  41.,  29.,
         34.,  24.,  20.,  13.,  16.,   9.,   8.,   9.,   7.,   7.],
       [  7.,   5.,   6.,   8.,   8.,  19.,  27.,  31.,  34.,  50.,  49.,
         78.,  54.,  66.,  68.,  65.,  49.,  58.,  48.,  40.,  32.,  23.,
         35.,  21.,  15.,  18.,  16.,   8.,  10.,   6.,   1.,   7.],
       [ 11.,   5.,   4.,   6.,  18.,  15.,  23.,  27.,  37.,  50.,  53.,
         52.,  54.,  68.,  60.,  52.,  52.,  45.,  47.,  32.,  31.,  19.,
         22.,  23.,  13.,  11.,  15.,  12.,  10.,   3.,   4.,   3.],
       [  4.,  10.,   4.,  15.,   8.,  19.,  31.,  24.,  30.,  56.,  53.,
         53.,  43.,  66.,  62.,  46.,  46.,  45.,  42.,  42.,  40.,  33.,
         26.,  23.,  15.,  14.,  21.,  12.,   9.,   7.,   4.,   3.],
       [  6.,   5.,  13.,   6.,  13.,  17.,  19.,  21.,  42.,  44.,  39.,
         57.,  61.,  60.,  65.,  63.,  58.,  47.,  39.,  50.,  37.,  30.,
         24.,  24.,  21.,  20.,   8.,   6.,   4.,   2.,   3.,   4.],
       [  1.,   6.,   8.,  11.,  13.,  13.,  26.,  37.,  37.,  39.,  49.,
         66.,  57.,  58.,  62.,  45.,  48.,  51.,  50.,  48.,  38.,  29.,
         18.,  26.,  26.,  20.,   8.,  14.,   8.,   5.,   4.,   3.],
       [  5.,   5.,   5.,  11.,   5.,  15.,  21.,  34.,  43.,  45.,  56.,
         55.,  56.,  53.,  58.,  60.,  56.,  36.,  42.,  51.,  30.,  44.,
         46.,  26.,  16.,  15.,  13.,  10.,   3.,   6.,   9.,   8.],
       [  9.,   5.,   5.,  10.,  15.,  18.,  27.,  34.,  35.,  32.,  42.,
         48.,  71.,  60.,  58.,  55.,  46.,  50.,  36.,  37.,  39.,  19.,
         23.,  24.,  16.,  10.,  16.,   7.,  10.,   9.,   1.,   3.],
       [  2.,   3.,  13.,   7.,  12.,  10.,  18.,  24.,  30.,  30.,  49.,
         41.,  59.,  72.,  72.,  48.,  58.,  59.,  45.,  46.,  31.,  31.,
         36.,  20.,  16.,  13.,  14.,  12.,   5.,   8.,   4.,   2.]])

        data = xpsi.Data(data_loaded,
	                         channels=np.arange(10,301),
	                         phases=np.linspace(0.0, 1.0, 33),
	                         first=0,
	                         last=290,
	                         exposure_time=1000.0)

        # # Instrument settings

        channel_number=np.arange(0,1501)    # The channel nnumber
        energy_low=np.arange(0,15.01, 0.01) # Lower bounds of each channel
        energy_high=energy_low+0.01         # Upper bounds of each channel
        channel_edges=np.array([list(channel_number),list(energy_low),list(energy_high)]).T

        # ARF
        arf_energy_low=[0.1]
        arf_energy_high=[0.105]
        arf_val=[1800]

        counter=1
        while arf_energy_low[-1]<=14.995:
	        arf_energy_low.append(arf_energy_low[-1]+0.005)
	        arf_energy_high.append(arf_energy_high[-1]+0.005)
	        arf_val.append(1800)
	        counter +=1


        ARF=np.array([list(arf_energy_low),
	                  list(arf_energy_high),
	                  list(arf_val)]).T

        # RMF
        RMF=np.diag(np.full(counter,1))


        Instrument = CustomInstrument.from_response_files(ARF =ARF,
	                                                 RMF = RMF,
	                                                 channel_edges =channel_edges,
	                                                 max_input = 301,
	                                                 min_input = 10,
	                                                 channel=[10,301])

        # # Signal
        signal = CustomSignal(data = data,
	                          instrument = Instrument,
	                          interstellar = None,
	                          cache = True,
	                          workspace_intervals = 1000,
	                          epsrel = 1.0e-8,
	                          epsilon = 1.0e-3,
	                          sigmas = 10.0)

        # # Space-time
        bounds = dict(distance = (0.5,2),
	                  mass = (1.0,1.6),
	                  radius = (10,13),
	                  cos_inclination = (0,1))


        spacetime = xpsi.Spacetime(bounds,
	                               values=dict(frequency = 314.0))

        # # Hot-spot
        bounds = dict(super_colatitude = (0.001, math.pi/2 - 0.001),
	                  super_radius = (0.001, math.pi/2 - 0.001),
	                  phase_shift = (-0.25, 0.75),
	                  super_temperature = (6., 7.))  # Valery model limit


        hot_spot = xpsi.HotRegion(bounds=bounds,
	                                    values={},
	                                    symmetry=True,
	                                    omit=False,
	                                    cede=False,
	                                    concentric=False,
	                                    sqrt_num_cells=32,
	                                    min_sqrt_num_cells=16,
	                                    max_sqrt_num_cells=64,
	                                    num_leaves=64,
	                                    num_rays=512,
	                                    is_secondary=True,
	                                    image_order_limit=3, # up to tertiary
	                                    prefix='hot')


        # # Photosphere
        photosphere = CustomPhotosphere(hot = hot_spot, elsewhere = None,
	                                    values=dict(mode_frequency = spacetime['frequency']))


        # # Star
        star = xpsi.Star(spacetime = spacetime, photospheres = photosphere)

        # # Prior
        prior = CustomPrior()


        # # Likelihood

        likelihood = xpsi.Likelihood(star = star, signals = signal,
	                                 num_energies = 128,
	                                 threads = 1,
	                                 externally_updated = True,
	                                 prior = prior)

        # Crucial step, if the likelihood check fails, then something went terrible wrong :)
        p=[1.4,10,1.,math.cos(60*np.pi/180),0.0,70*np.pi/180, 0.75,6.8]

        #likelihood.check(None, [-47881.27817666349], 1.0e-5, physical_points=[p])
        assert np.isclose(-47881.27817666349, likelihood(p,force=True,reinitialise=True), rtol=1.0e-5)
